[2024-06-20T11:41:10.403+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-06-20T11:41:10.448+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T11:41:10.458+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T11:41:10.458+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2024-06-20T11:41:10.473+0000] {taskinstance.py:2330} INFO - Executing <Task(BashOperator): dbt_run> on 2024-06-18 00:00:00+00:00
[2024-06-20T11:41:10.487+0000] {logging_mixin.py:188} WARNING - /home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=9686) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2024-06-20T11:41:10.489+0000] {standard_task_runner.py:63} INFO - Started process 9709 to run task
[2024-06-20T11:41:10.491+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'nba_data_pipeline_dag', 'dbt_run', 'scheduled__2024-06-18T00:00:00+00:00', '--job-id', '854', '--raw', '--subdir', 'DAGS_FOLDER/nba_data_pipeline_dag.py', '--cfg-path', '/tmp/tmp8e1l3bxt']
[2024-06-20T11:41:10.494+0000] {standard_task_runner.py:91} INFO - Job 854: Subtask dbt_run
[2024-06-20T11:41:10.605+0000] {task_command.py:426} INFO - Running <TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [running]> on host ip-172-31-45-144.ec2.internal
[2024-06-20T11:41:10.784+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Airflow' AIRFLOW_CTX_DAG_ID='nba_data_pipeline_dag' AIRFLOW_CTX_TASK_ID='dbt_run' AIRFLOW_CTX_EXECUTION_DATE='2024-06-18T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-18T00:00:00+00:00'
[2024-06-20T11:41:10.785+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-06-20T11:41:10.800+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2024-06-20T11:41:10.801+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /home/ubuntu/nba_project && dbt run']
[2024-06-20T11:41:10.815+0000] {subprocess.py:86} INFO - Output:
[2024-06-20T11:41:13.052+0000] {subprocess.py:93} INFO - [0m11:41:13  Running with dbt=1.8.2
[2024-06-20T11:41:14.549+0000] {subprocess.py:93} INFO - [0m11:41:14  Registered adapter: snowflake=1.8.3
[2024-06-20T11:41:14.579+0000] {subprocess.py:93} INFO - [0m11:41:14  Unable to do partial parsing because saved manifest not found. Starting full parse.
[2024-06-20T11:41:16.059+0000] {subprocess.py:93} INFO - [0m11:41:16  [[33mWARNING[0m]: Did not find matching node for patch with name 'staging_player_stats' in the 'models' section of file 'models/schema.yml'
[2024-06-20T11:41:16.068+0000] {subprocess.py:93} INFO - [0m11:41:16  [[33mWARNING[0m]: Did not find matching node for patch with name 'staging_nba_scores' in the 'models' section of file 'models/schema.yml'
[2024-06-20T11:41:16.074+0000] {subprocess.py:93} INFO - [0m11:41:16  [[33mWARNING[0m]: Did not find matching node for patch with name 'staging_nba_news' in the 'models' section of file 'models/schema.yml'
[2024-06-20T11:41:16.077+0000] {subprocess.py:93} INFO - [0m11:41:16  [[33mWARNING[0m]: Did not find matching node for patch with name 'staging_top_100_players_stats' in the 'models' section of file 'models/schema.yml'
[2024-06-20T11:41:16.242+0000] {subprocess.py:93} INFO - [0m11:41:16  Encountered an error:
[2024-06-20T11:41:16.243+0000] {subprocess.py:93} INFO - Compilation Error
[2024-06-20T11:41:16.243+0000] {subprocess.py:93} INFO -   Model 'model.nba_project.player_stats' (models/staging/player_stats.sql) depends on a source named 'nba_stats.player_stats' which was not found
[2024-06-20T11:41:16.955+0000] {subprocess.py:97} INFO - Command exited with return code 2
[2024-06-20T11:41:16.956+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-06-20T11:41:16.983+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/operators/bash.py", line 243, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 2.
[2024-06-20T11:41:16.988+0000] {taskinstance.py:1206} INFO - Marking task as UP_FOR_RETRY. dag_id=nba_data_pipeline_dag, task_id=dbt_run, run_id=scheduled__2024-06-18T00:00:00+00:00, execution_date=20240618T000000, start_date=20240620T114110, end_date=20240620T114116
[2024-06-20T11:41:17.002+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 854 for task dbt_run (Bash command failed. The command returned a non-zero exit code 2.; 9709)
[2024-06-20T11:41:17.029+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2024-06-20T11:41:17.060+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-06-20T11:41:17.062+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-06-20T11:53:09.668+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-06-20T11:53:09.715+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T11:53:09.726+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T11:53:09.727+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2024-06-20T11:53:09.740+0000] {taskinstance.py:2330} INFO - Executing <Task(BashOperator): dbt_run> on 2024-06-18 00:00:00+00:00
[2024-06-20T11:53:09.756+0000] {logging_mixin.py:188} WARNING - /home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=16758) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2024-06-20T11:53:09.761+0000] {standard_task_runner.py:63} INFO - Started process 16865 to run task
[2024-06-20T11:53:09.758+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'nba_data_pipeline_dag', 'dbt_run', 'scheduled__2024-06-18T00:00:00+00:00', '--job-id', '891', '--raw', '--subdir', 'DAGS_FOLDER/nba_data_pipeline_dag.py', '--cfg-path', '/tmp/tmp7j393m92']
[2024-06-20T11:53:09.763+0000] {standard_task_runner.py:91} INFO - Job 891: Subtask dbt_run
[2024-06-20T11:53:09.883+0000] {task_command.py:426} INFO - Running <TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [running]> on host ip-172-31-45-144.ec2.internal
[2024-06-20T11:53:10.071+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Airflow' AIRFLOW_CTX_DAG_ID='nba_data_pipeline_dag' AIRFLOW_CTX_TASK_ID='dbt_run' AIRFLOW_CTX_EXECUTION_DATE='2024-06-18T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-18T00:00:00+00:00'
[2024-06-20T11:53:10.072+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-06-20T11:53:10.101+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2024-06-20T11:53:10.103+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /home/ubuntu/nba_project && dbt run']
[2024-06-20T11:53:10.121+0000] {subprocess.py:86} INFO - Output:
[2024-06-20T11:53:12.428+0000] {subprocess.py:93} INFO - [0m11:53:12  Running with dbt=1.8.2
[2024-06-20T11:53:13.565+0000] {subprocess.py:93} INFO - [0m11:53:13  Registered adapter: snowflake=1.8.3
[2024-06-20T11:53:13.595+0000] {subprocess.py:93} INFO - [0m11:53:13  Unable to do partial parsing because saved manifest not found. Starting full parse.
[2024-06-20T11:53:15.328+0000] {subprocess.py:93} INFO - [0m11:53:15  Encountered an error:
[2024-06-20T11:53:15.329+0000] {subprocess.py:93} INFO - Compilation Error
[2024-06-20T11:53:15.329+0000] {subprocess.py:93} INFO -   Model 'model.nba_project.staging_player_stats' (models/staging/staging_player_stats.sql) depends on a source named 'nba_stats.player_stats' which was not found
[2024-06-20T11:53:16.028+0000] {subprocess.py:97} INFO - Command exited with return code 2
[2024-06-20T11:53:16.029+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-06-20T11:53:16.057+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/operators/bash.py", line 243, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 2.
[2024-06-20T11:53:16.062+0000] {taskinstance.py:1206} INFO - Marking task as UP_FOR_RETRY. dag_id=nba_data_pipeline_dag, task_id=dbt_run, run_id=scheduled__2024-06-18T00:00:00+00:00, execution_date=20240618T000000, start_date=20240620T115309, end_date=20240620T115316
[2024-06-20T11:53:16.075+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 891 for task dbt_run (Bash command failed. The command returned a non-zero exit code 2.; 16865)
[2024-06-20T11:53:16.123+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2024-06-20T11:53:16.154+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-06-20T11:53:16.156+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-06-20T12:13:09.729+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-06-20T12:13:09.774+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T12:13:09.784+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T12:13:09.784+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2024-06-20T12:13:09.797+0000] {taskinstance.py:2330} INFO - Executing <Task(BashOperator): dbt_run> on 2024-06-18 00:00:00+00:00
[2024-06-20T12:13:09.807+0000] {logging_mixin.py:188} WARNING - /home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=24750) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2024-06-20T12:13:09.808+0000] {standard_task_runner.py:63} INFO - Started process 24843 to run task
[2024-06-20T12:13:09.807+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'nba_data_pipeline_dag', 'dbt_run', 'scheduled__2024-06-18T00:00:00+00:00', '--job-id', '938', '--raw', '--subdir', 'DAGS_FOLDER/nba_data_pipeline_dag.py', '--cfg-path', '/tmp/tmpfkaliz0r']
[2024-06-20T12:13:09.810+0000] {standard_task_runner.py:91} INFO - Job 938: Subtask dbt_run
[2024-06-20T12:13:09.908+0000] {task_command.py:426} INFO - Running <TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [running]> on host ip-172-31-45-144.ec2.internal
[2024-06-20T12:13:10.068+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Airflow' AIRFLOW_CTX_DAG_ID='nba_data_pipeline_dag' AIRFLOW_CTX_TASK_ID='dbt_run' AIRFLOW_CTX_EXECUTION_DATE='2024-06-18T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-18T00:00:00+00:00'
[2024-06-20T12:13:10.069+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-06-20T12:13:10.083+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2024-06-20T12:13:10.084+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /home/ubuntu/nba_project && dbt run']
[2024-06-20T12:13:10.098+0000] {subprocess.py:86} INFO - Output:
[2024-06-20T12:13:12.170+0000] {subprocess.py:93} INFO - [0m12:13:12  Running with dbt=1.8.2
[2024-06-20T12:13:13.357+0000] {subprocess.py:93} INFO - [0m12:13:13  Registered adapter: snowflake=1.8.3
[2024-06-20T12:13:13.387+0000] {subprocess.py:93} INFO - [0m12:13:13  Unable to do partial parsing because saved manifest not found. Starting full parse.
[2024-06-20T12:13:15.570+0000] {subprocess.py:93} INFO - [0m12:13:15  Found 8 models, 4 sources, 444 macros
[2024-06-20T12:13:15.575+0000] {subprocess.py:93} INFO - [0m12:13:15
[2024-06-20T12:13:16.770+0000] {subprocess.py:93} INFO - [0m12:13:16
[2024-06-20T12:13:16.770+0000] {subprocess.py:93} INFO - [0m12:13:16  Finished running  in 0 hours 0 minutes and 1.19 seconds (1.19s).
[2024-06-20T12:13:16.771+0000] {subprocess.py:93} INFO - [0m12:13:16  Encountered an error:
[2024-06-20T12:13:16.771+0000] {subprocess.py:93} INFO - Runtime Error
[2024-06-20T12:13:16.771+0000] {subprocess.py:93} INFO -   Database error while listing schemas in database "NBA_STATS_ANALYTICS"
[2024-06-20T12:13:16.771+0000] {subprocess.py:93} INFO -   Database Error
[2024-06-20T12:13:16.771+0000] {subprocess.py:93} INFO -     250001 (08001): Failed to connect to DB: lv27483.us-east-2.aws.snowflakecomputing.com:443. Role 'DEV' specified in the connect string does not exist or not authorized. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.
[2024-06-20T12:13:17.585+0000] {subprocess.py:97} INFO - Command exited with return code 2
[2024-06-20T12:13:17.586+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-06-20T12:13:17.614+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/operators/bash.py", line 243, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 2.
[2024-06-20T12:13:17.620+0000] {taskinstance.py:1206} INFO - Marking task as UP_FOR_RETRY. dag_id=nba_data_pipeline_dag, task_id=dbt_run, run_id=scheduled__2024-06-18T00:00:00+00:00, execution_date=20240618T000000, start_date=20240620T121309, end_date=20240620T121317
[2024-06-20T12:13:17.634+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 938 for task dbt_run (Bash command failed. The command returned a non-zero exit code 2.; 24843)
[2024-06-20T12:13:17.671+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2024-06-20T12:13:17.702+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-06-20T12:13:17.705+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-06-20T12:21:38.595+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-06-20T12:21:38.671+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T12:21:38.682+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T12:21:38.683+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2024-06-20T12:21:38.700+0000] {taskinstance.py:2330} INFO - Executing <Task(BashOperator): dbt_run> on 2024-06-18 00:00:00+00:00
[2024-06-20T12:21:38.720+0000] {logging_mixin.py:188} WARNING - /home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=30907) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2024-06-20T12:21:38.724+0000] {standard_task_runner.py:63} INFO - Started process 30969 to run task
[2024-06-20T12:21:38.719+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'nba_data_pipeline_dag', 'dbt_run', 'scheduled__2024-06-18T00:00:00+00:00', '--job-id', '974', '--raw', '--subdir', 'DAGS_FOLDER/nba_data_pipeline_dag.py', '--cfg-path', '/tmp/tmp2qy1orpd']
[2024-06-20T12:21:38.726+0000] {standard_task_runner.py:91} INFO - Job 974: Subtask dbt_run
[2024-06-20T12:21:38.843+0000] {task_command.py:426} INFO - Running <TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [running]> on host ip-172-31-45-144.ec2.internal
[2024-06-20T12:21:39.007+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Airflow' AIRFLOW_CTX_DAG_ID='nba_data_pipeline_dag' AIRFLOW_CTX_TASK_ID='dbt_run' AIRFLOW_CTX_EXECUTION_DATE='2024-06-18T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-18T00:00:00+00:00'
[2024-06-20T12:21:39.011+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-06-20T12:21:39.026+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2024-06-20T12:21:39.027+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /home/ubuntu/nba_project && dbt run']
[2024-06-20T12:21:39.043+0000] {subprocess.py:86} INFO - Output:
[2024-06-20T12:21:41.336+0000] {subprocess.py:93} INFO - [0m12:21:41  Running with dbt=1.8.2
[2024-06-20T12:21:42.425+0000] {subprocess.py:93} INFO - [0m12:21:42  Registered adapter: snowflake=1.8.3
[2024-06-20T12:21:42.634+0000] {subprocess.py:93} INFO - [0m12:21:42  Unable to do partial parsing because profile has changed
[2024-06-20T12:21:44.835+0000] {subprocess.py:93} INFO - [0m12:21:44  Found 8 models, 4 sources, 444 macros
[2024-06-20T12:21:44.842+0000] {subprocess.py:93} INFO - [0m12:21:44
[2024-06-20T12:21:46.292+0000] {subprocess.py:93} INFO - [0m12:21:46  Concurrency: 1 threads (target='dev')
[2024-06-20T12:21:46.293+0000] {subprocess.py:93} INFO - [0m12:21:46
[2024-06-20T12:21:46.297+0000] {subprocess.py:93} INFO - [0m12:21:46  1 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ........... [RUN]
[2024-06-20T12:21:46.997+0000] {subprocess.py:93} INFO - [0m12:21:46  1 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ...... [[32mSUCCESS 1[0m in 0.70s]
[2024-06-20T12:21:46.999+0000] {subprocess.py:93} INFO - [0m12:21:46  2 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores ......... [RUN]
[2024-06-20T12:21:47.485+0000] {subprocess.py:93} INFO - [0m12:21:47  2 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores .... [[32mSUCCESS 1[0m in 0.48s]
[2024-06-20T12:21:47.488+0000] {subprocess.py:93} INFO - [0m12:21:47  3 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_player_stats ....... [RUN]
[2024-06-20T12:21:47.983+0000] {subprocess.py:93} INFO - [0m12:21:47  3 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_player_stats .. [[32mSUCCESS 1[0m in 0.49s]
[2024-06-20T12:21:47.986+0000] {subprocess.py:93} INFO - [0m12:21:47  4 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [RUN]
[2024-06-20T12:21:48.696+0000] {subprocess.py:93} INFO - [0m12:21:48  4 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [[32mSUCCESS 1[0m in 0.71s]
[2024-06-20T12:21:48.700+0000] {subprocess.py:93} INFO - [0m12:21:48  5 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news ...... [RUN]
[2024-06-20T12:21:49.192+0000] {subprocess.py:93} INFO - [0m12:21:49  5 of 8 ERROR creating sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news  [[31mERROR[0m in 0.49s]
[2024-06-20T12:21:49.195+0000] {subprocess.py:93} INFO - [0m12:21:49  6 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores .... [RUN]
[2024-06-20T12:21:50.000+0000] {subprocess.py:93} INFO - [0m12:21:50  6 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores  [[32mSUCCESS 1[0m in 0.80s]
[2024-06-20T12:21:50.003+0000] {subprocess.py:93} INFO - [0m12:21:50  7 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats .. [RUN]
[2024-06-20T12:21:51.101+0000] {subprocess.py:93} INFO - [0m12:21:51  7 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats  [[32mSUCCESS 1[0m in 1.10s]
[2024-06-20T12:21:51.104+0000] {subprocess.py:93} INFO - [0m12:21:51  8 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [RUN]
[2024-06-20T12:21:52.027+0000] {subprocess.py:93} INFO - [0m12:21:52  8 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [[32mSUCCESS 1[0m in 0.92s]
[2024-06-20T12:21:52.031+0000] {subprocess.py:93} INFO - [0m12:21:52
[2024-06-20T12:21:52.032+0000] {subprocess.py:93} INFO - [0m12:21:52  Finished running 4 view models, 4 table models in 0 hours 0 minutes and 7.19 seconds (7.19s).
[2024-06-20T12:21:52.071+0000] {subprocess.py:93} INFO - [0m12:21:52
[2024-06-20T12:21:52.072+0000] {subprocess.py:93} INFO - [0m12:21:52  [31mCompleted with 1 error and 0 warnings:[0m
[2024-06-20T12:21:52.073+0000] {subprocess.py:93} INFO - [0m12:21:52
[2024-06-20T12:21:52.073+0000] {subprocess.py:93} INFO - [0m12:21:52    Database Error in model transformed_nba_news (models/transformed/transformed_nba_news.sql)
[2024-06-20T12:21:52.073+0000] {subprocess.py:93} INFO -   000904 (42000): SQL compilation error: error line 9 at position 8
[2024-06-20T12:21:52.074+0000] {subprocess.py:93} INFO -   invalid identifier 'SOURCE'
[2024-06-20T12:21:52.074+0000] {subprocess.py:93} INFO -   compiled Code at target/run/nba_project/models/transformed/transformed_nba_news.sql
[2024-06-20T12:21:52.074+0000] {subprocess.py:93} INFO - [0m12:21:52
[2024-06-20T12:21:52.074+0000] {subprocess.py:93} INFO - [0m12:21:52  Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[2024-06-20T12:21:52.941+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2024-06-20T12:21:52.942+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-06-20T12:21:52.969+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/operators/bash.py", line 243, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2024-06-20T12:21:52.974+0000] {taskinstance.py:1206} INFO - Marking task as UP_FOR_RETRY. dag_id=nba_data_pipeline_dag, task_id=dbt_run, run_id=scheduled__2024-06-18T00:00:00+00:00, execution_date=20240618T000000, start_date=20240620T122138, end_date=20240620T122152
[2024-06-20T12:21:52.988+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 974 for task dbt_run (Bash command failed. The command returned a non-zero exit code 1.; 30969)
[2024-06-20T12:21:53.021+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2024-06-20T12:21:53.052+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-06-20T12:21:53.054+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-06-20T12:40:30.604+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-06-20T12:40:30.649+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T12:40:30.659+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T12:40:30.660+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2024-06-20T12:40:30.673+0000] {taskinstance.py:2330} INFO - Executing <Task(BashOperator): dbt_run> on 2024-06-18 00:00:00+00:00
[2024-06-20T12:40:30.689+0000] {logging_mixin.py:188} WARNING - /home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=39056) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2024-06-20T12:40:30.692+0000] {standard_task_runner.py:63} INFO - Started process 39064 to run task
[2024-06-20T12:40:30.690+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'nba_data_pipeline_dag', 'dbt_run', 'scheduled__2024-06-18T00:00:00+00:00', '--job-id', '1025', '--raw', '--subdir', 'DAGS_FOLDER/nba_data_pipeline_dag.py', '--cfg-path', '/tmp/tmpxpq7n_xp']
[2024-06-20T12:40:30.696+0000] {standard_task_runner.py:91} INFO - Job 1025: Subtask dbt_run
[2024-06-20T12:40:30.808+0000] {task_command.py:426} INFO - Running <TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [running]> on host ip-172-31-45-144.ec2.internal
[2024-06-20T12:40:30.998+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Airflow' AIRFLOW_CTX_DAG_ID='nba_data_pipeline_dag' AIRFLOW_CTX_TASK_ID='dbt_run' AIRFLOW_CTX_EXECUTION_DATE='2024-06-18T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-18T00:00:00+00:00'
[2024-06-20T12:40:30.999+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-06-20T12:40:31.014+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2024-06-20T12:40:31.015+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /home/ubuntu/nba_project && dbt run']
[2024-06-20T12:40:31.032+0000] {subprocess.py:86} INFO - Output:
[2024-06-20T12:40:33.447+0000] {subprocess.py:93} INFO - [0m12:40:33  Running with dbt=1.8.2
[2024-06-20T12:40:34.503+0000] {subprocess.py:93} INFO - [0m12:40:34  Registered adapter: snowflake=1.8.3
[2024-06-20T12:40:34.822+0000] {subprocess.py:93} INFO - [0m12:40:34  Found 8 models, 4 sources, 444 macros
[2024-06-20T12:40:34.825+0000] {subprocess.py:93} INFO - [0m12:40:34
[2024-06-20T12:40:41.307+0000] {subprocess.py:93} INFO - [0m12:40:41  Concurrency: 1 threads (target='dev')
[2024-06-20T12:40:41.307+0000] {subprocess.py:93} INFO - [0m12:40:41
[2024-06-20T12:40:41.317+0000] {subprocess.py:93} INFO - [0m12:40:41  1 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ........... [RUN]
[2024-06-20T12:40:42.436+0000] {subprocess.py:93} INFO - [0m12:40:42  1 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ...... [[32mSUCCESS 1[0m in 1.12s]
[2024-06-20T12:40:42.439+0000] {subprocess.py:93} INFO - [0m12:40:42  2 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores ......... [RUN]
[2024-06-20T12:40:42.883+0000] {subprocess.py:93} INFO - [0m12:40:42  2 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores .... [[32mSUCCESS 1[0m in 0.44s]
[2024-06-20T12:40:42.886+0000] {subprocess.py:93} INFO - [0m12:40:42  3 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_player_stats ....... [RUN]
[2024-06-20T12:40:43.398+0000] {subprocess.py:93} INFO - [0m12:40:43  3 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_player_stats .. [[32mSUCCESS 1[0m in 0.51s]
[2024-06-20T12:40:43.400+0000] {subprocess.py:93} INFO - [0m12:40:43  4 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [RUN]
[2024-06-20T12:40:44.239+0000] {subprocess.py:93} INFO - [0m12:40:44  4 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [[32mSUCCESS 1[0m in 0.83s]
[2024-06-20T12:40:44.240+0000] {subprocess.py:93} INFO - [0m12:40:44  5 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news ...... [RUN]
[2024-06-20T12:40:47.352+0000] {subprocess.py:93} INFO - [0m12:40:47  5 of 8 ERROR creating sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news  [[31mERROR[0m in 3.11s]
[2024-06-20T12:40:47.355+0000] {subprocess.py:93} INFO - [0m12:40:47  6 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores .... [RUN]
[2024-06-20T12:40:48.152+0000] {subprocess.py:93} INFO - [0m12:40:48  6 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores  [[32mSUCCESS 1[0m in 0.80s]
[2024-06-20T12:40:48.155+0000] {subprocess.py:93} INFO - [0m12:40:48  7 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats .. [RUN]
[2024-06-20T12:40:49.271+0000] {subprocess.py:93} INFO - [0m12:40:49  7 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats  [[32mSUCCESS 1[0m in 1.11s]
[2024-06-20T12:40:49.273+0000] {subprocess.py:93} INFO - [0m12:40:49  8 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [RUN]
[2024-06-20T12:40:51.714+0000] {subprocess.py:93} INFO - [0m12:40:51  8 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [[32mSUCCESS 1[0m in 2.44s]
[2024-06-20T12:40:51.717+0000] {subprocess.py:93} INFO - [0m12:40:51
[2024-06-20T12:40:51.719+0000] {subprocess.py:93} INFO - [0m12:40:51  Finished running 4 view models, 4 table models in 0 hours 0 minutes and 16.89 seconds (16.89s).
[2024-06-20T12:40:51.916+0000] {subprocess.py:93} INFO - [0m12:40:51
[2024-06-20T12:40:51.916+0000] {subprocess.py:93} INFO - [0m12:40:51  [31mCompleted with 1 error and 0 warnings:[0m
[2024-06-20T12:40:51.917+0000] {subprocess.py:93} INFO - [0m12:40:51
[2024-06-20T12:40:51.917+0000] {subprocess.py:93} INFO - [0m12:40:51    Database Error in model transformed_nba_news (models/transformed/transformed_nba_news.sql)
[2024-06-20T12:40:51.917+0000] {subprocess.py:93} INFO -   000904 (42000): SQL compilation error: error line 9 at position 8
[2024-06-20T12:40:51.918+0000] {subprocess.py:93} INFO -   invalid identifier '"source"'
[2024-06-20T12:40:51.918+0000] {subprocess.py:93} INFO -   compiled Code at target/run/nba_project/models/transformed/transformed_nba_news.sql
[2024-06-20T12:40:51.918+0000] {subprocess.py:93} INFO - [0m12:40:51
[2024-06-20T12:40:51.918+0000] {subprocess.py:93} INFO - [0m12:40:51  Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[2024-06-20T12:40:52.615+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2024-06-20T12:40:52.616+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-06-20T12:40:52.643+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/operators/bash.py", line 243, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2024-06-20T12:40:52.648+0000] {taskinstance.py:1206} INFO - Marking task as UP_FOR_RETRY. dag_id=nba_data_pipeline_dag, task_id=dbt_run, run_id=scheduled__2024-06-18T00:00:00+00:00, execution_date=20240618T000000, start_date=20240620T124030, end_date=20240620T124052
[2024-06-20T12:40:52.662+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 1025 for task dbt_run (Bash command failed. The command returned a non-zero exit code 1.; 39064)
[2024-06-20T12:40:52.690+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2024-06-20T12:40:52.721+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-06-20T12:40:52.722+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-06-20T12:50:04.845+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-06-20T12:50:04.892+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T12:50:04.903+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T12:50:04.903+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2024-06-20T12:50:04.917+0000] {taskinstance.py:2330} INFO - Executing <Task(BashOperator): dbt_run> on 2024-06-18 00:00:00+00:00
[2024-06-20T12:50:04.934+0000] {logging_mixin.py:188} WARNING - /home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=45006) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2024-06-20T12:50:04.937+0000] {standard_task_runner.py:63} INFO - Started process 45029 to run task
[2024-06-20T12:50:04.936+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'nba_data_pipeline_dag', 'dbt_run', 'scheduled__2024-06-18T00:00:00+00:00', '--job-id', '1061', '--raw', '--subdir', 'DAGS_FOLDER/nba_data_pipeline_dag.py', '--cfg-path', '/tmp/tmpng9yp1aa']
[2024-06-20T12:50:04.942+0000] {standard_task_runner.py:91} INFO - Job 1061: Subtask dbt_run
[2024-06-20T12:50:05.078+0000] {task_command.py:426} INFO - Running <TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [running]> on host ip-172-31-45-144.ec2.internal
[2024-06-20T12:50:05.269+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Airflow' AIRFLOW_CTX_DAG_ID='nba_data_pipeline_dag' AIRFLOW_CTX_TASK_ID='dbt_run' AIRFLOW_CTX_EXECUTION_DATE='2024-06-18T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-18T00:00:00+00:00'
[2024-06-20T12:50:05.273+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-06-20T12:50:05.288+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2024-06-20T12:50:05.289+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /home/ubuntu/nba_project && dbt run']
[2024-06-20T12:50:05.305+0000] {subprocess.py:86} INFO - Output:
[2024-06-20T12:50:07.743+0000] {subprocess.py:93} INFO - [0m12:50:07  Running with dbt=1.8.2
[2024-06-20T12:50:08.954+0000] {subprocess.py:93} INFO - [0m12:50:08  Registered adapter: snowflake=1.8.3
[2024-06-20T12:50:09.281+0000] {subprocess.py:93} INFO - [0m12:50:09  Found 8 models, 4 sources, 444 macros
[2024-06-20T12:50:09.284+0000] {subprocess.py:93} INFO - [0m12:50:09
[2024-06-20T12:50:10.394+0000] {subprocess.py:93} INFO - [0m12:50:10  Concurrency: 1 threads (target='dev')
[2024-06-20T12:50:10.397+0000] {subprocess.py:93} INFO - [0m12:50:10
[2024-06-20T12:50:10.401+0000] {subprocess.py:93} INFO - [0m12:50:10  1 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ........... [RUN]
[2024-06-20T12:50:11.031+0000] {subprocess.py:93} INFO - [0m12:50:11  1 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ...... [[32mSUCCESS 1[0m in 0.63s]
[2024-06-20T12:50:11.033+0000] {subprocess.py:93} INFO - [0m12:50:11  2 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores ......... [RUN]
[2024-06-20T12:50:11.571+0000] {subprocess.py:93} INFO - [0m12:50:11  2 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores .... [[32mSUCCESS 1[0m in 0.53s]
[2024-06-20T12:50:11.574+0000] {subprocess.py:93} INFO - [0m12:50:11  3 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_player_stats ....... [RUN]
[2024-06-20T12:50:12.258+0000] {subprocess.py:93} INFO - [0m12:50:12  3 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_player_stats .. [[32mSUCCESS 1[0m in 0.68s]
[2024-06-20T12:50:12.262+0000] {subprocess.py:93} INFO - [0m12:50:12  4 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [RUN]
[2024-06-20T12:50:13.016+0000] {subprocess.py:93} INFO - [0m12:50:13  4 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [[32mSUCCESS 1[0m in 0.75s]
[2024-06-20T12:50:13.019+0000] {subprocess.py:93} INFO - [0m12:50:13  5 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news ...... [RUN]
[2024-06-20T12:50:13.612+0000] {subprocess.py:93} INFO - [0m12:50:13  5 of 8 ERROR creating sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news  [[31mERROR[0m in 0.59s]
[2024-06-20T12:50:13.615+0000] {subprocess.py:93} INFO - [0m12:50:13  6 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores .... [RUN]
[2024-06-20T12:50:18.798+0000] {subprocess.py:93} INFO - [0m12:50:18  6 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores  [[32mSUCCESS 1[0m in 5.18s]
[2024-06-20T12:50:18.800+0000] {subprocess.py:93} INFO - [0m12:50:18  7 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats .. [RUN]
[2024-06-20T12:50:20.831+0000] {subprocess.py:93} INFO - [0m12:50:20  7 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats  [[32mSUCCESS 1[0m in 2.03s]
[2024-06-20T12:50:20.834+0000] {subprocess.py:93} INFO - [0m12:50:20  8 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [RUN]
[2024-06-20T12:50:22.055+0000] {subprocess.py:93} INFO - [0m12:50:22  8 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [[32mSUCCESS 1[0m in 1.22s]
[2024-06-20T12:50:22.059+0000] {subprocess.py:93} INFO - [0m12:50:22
[2024-06-20T12:50:22.062+0000] {subprocess.py:93} INFO - [0m12:50:22  Finished running 4 view models, 4 table models in 0 hours 0 minutes and 12.77 seconds (12.77s).
[2024-06-20T12:50:22.245+0000] {subprocess.py:93} INFO - [0m12:50:22
[2024-06-20T12:50:22.246+0000] {subprocess.py:93} INFO - [0m12:50:22  [31mCompleted with 1 error and 0 warnings:[0m
[2024-06-20T12:50:22.246+0000] {subprocess.py:93} INFO - [0m12:50:22
[2024-06-20T12:50:22.247+0000] {subprocess.py:93} INFO - [0m12:50:22    Database Error in model transformed_nba_news (models/transformed/transformed_nba_news.sql)
[2024-06-20T12:50:22.247+0000] {subprocess.py:93} INFO -   000904 (42000): SQL compilation error: error line 9 at position 8
[2024-06-20T12:50:22.247+0000] {subprocess.py:93} INFO -   invalid identifier 'SOURCE'
[2024-06-20T12:50:22.248+0000] {subprocess.py:93} INFO -   compiled Code at target/run/nba_project/models/transformed/transformed_nba_news.sql
[2024-06-20T12:50:22.248+0000] {subprocess.py:93} INFO - [0m12:50:22
[2024-06-20T12:50:22.248+0000] {subprocess.py:93} INFO - [0m12:50:22  Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[2024-06-20T12:50:22.993+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2024-06-20T12:50:22.994+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-06-20T12:50:23.021+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/operators/bash.py", line 243, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2024-06-20T12:50:23.027+0000] {taskinstance.py:1206} INFO - Marking task as UP_FOR_RETRY. dag_id=nba_data_pipeline_dag, task_id=dbt_run, run_id=scheduled__2024-06-18T00:00:00+00:00, execution_date=20240618T000000, start_date=20240620T125004, end_date=20240620T125023
[2024-06-20T12:50:23.040+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 1061 for task dbt_run (Bash command failed. The command returned a non-zero exit code 1.; 45029)
[2024-06-20T12:50:23.065+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2024-06-20T12:50:23.099+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-06-20T12:50:23.101+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-06-20T12:55:30.846+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-06-20T12:55:30.922+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T12:55:30.933+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T12:55:30.934+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2024-06-20T12:55:30.949+0000] {taskinstance.py:2330} INFO - Executing <Task(BashOperator): dbt_run> on 2024-06-18 00:00:00+00:00
[2024-06-20T12:55:30.969+0000] {logging_mixin.py:188} WARNING - /home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=50873) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2024-06-20T12:55:30.973+0000] {standard_task_runner.py:63} INFO - Started process 50994 to run task
[2024-06-20T12:55:30.969+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'nba_data_pipeline_dag', 'dbt_run', 'scheduled__2024-06-18T00:00:00+00:00', '--job-id', '1096', '--raw', '--subdir', 'DAGS_FOLDER/nba_data_pipeline_dag.py', '--cfg-path', '/tmp/tmpfjszavm6']
[2024-06-20T12:55:30.975+0000] {standard_task_runner.py:91} INFO - Job 1096: Subtask dbt_run
[2024-06-20T12:55:31.099+0000] {task_command.py:426} INFO - Running <TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [running]> on host ip-172-31-45-144.ec2.internal
[2024-06-20T12:55:31.273+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Airflow' AIRFLOW_CTX_DAG_ID='nba_data_pipeline_dag' AIRFLOW_CTX_TASK_ID='dbt_run' AIRFLOW_CTX_EXECUTION_DATE='2024-06-18T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-18T00:00:00+00:00'
[2024-06-20T12:55:31.275+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-06-20T12:55:31.289+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2024-06-20T12:55:31.290+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /home/ubuntu/nba_project && dbt run']
[2024-06-20T12:55:31.307+0000] {subprocess.py:86} INFO - Output:
[2024-06-20T12:55:33.714+0000] {subprocess.py:93} INFO - [0m12:55:33  Running with dbt=1.8.2
[2024-06-20T12:55:34.889+0000] {subprocess.py:93} INFO - [0m12:55:34  Registered adapter: snowflake=1.8.3
[2024-06-20T12:55:35.274+0000] {subprocess.py:93} INFO - [0m12:55:35  Found 8 models, 4 sources, 444 macros
[2024-06-20T12:55:35.280+0000] {subprocess.py:93} INFO - [0m12:55:35
[2024-06-20T12:55:37.469+0000] {subprocess.py:93} INFO - [0m12:55:37  Concurrency: 1 threads (target='dev')
[2024-06-20T12:55:37.469+0000] {subprocess.py:93} INFO - [0m12:55:37
[2024-06-20T12:55:37.474+0000] {subprocess.py:93} INFO - [0m12:55:37  1 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ........... [RUN]
[2024-06-20T12:55:38.115+0000] {subprocess.py:93} INFO - [0m12:55:38  1 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ...... [[32mSUCCESS 1[0m in 0.64s]
[2024-06-20T12:55:38.118+0000] {subprocess.py:93} INFO - [0m12:55:38  2 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores ......... [RUN]
[2024-06-20T12:55:38.554+0000] {subprocess.py:93} INFO - [0m12:55:38  2 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores .... [[32mSUCCESS 1[0m in 0.43s]
[2024-06-20T12:55:38.557+0000] {subprocess.py:93} INFO - [0m12:55:38  3 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_player_stats ....... [RUN]
[2024-06-20T12:55:39.012+0000] {subprocess.py:93} INFO - [0m12:55:39  3 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_player_stats .. [[32mSUCCESS 1[0m in 0.45s]
[2024-06-20T12:55:39.017+0000] {subprocess.py:93} INFO - [0m12:55:39  4 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [RUN]
[2024-06-20T12:55:39.450+0000] {subprocess.py:93} INFO - [0m12:55:39  4 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [[32mSUCCESS 1[0m in 0.43s]
[2024-06-20T12:55:39.453+0000] {subprocess.py:93} INFO - [0m12:55:39  5 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news ...... [RUN]
[2024-06-20T12:55:44.094+0000] {subprocess.py:93} INFO - [0m12:55:44  5 of 8 ERROR creating sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news  [[31mERROR[0m in 4.64s]
[2024-06-20T12:55:44.098+0000] {subprocess.py:93} INFO - [0m12:55:44  6 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores .... [RUN]
[2024-06-20T12:55:45.098+0000] {subprocess.py:93} INFO - [0m12:55:45  6 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores  [[32mSUCCESS 1[0m in 1.00s]
[2024-06-20T12:55:45.101+0000] {subprocess.py:93} INFO - [0m12:55:45  7 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats .. [RUN]
[2024-06-20T12:55:46.178+0000] {subprocess.py:93} INFO - [0m12:55:46  7 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats  [[32mSUCCESS 1[0m in 1.07s]
[2024-06-20T12:55:46.181+0000] {subprocess.py:93} INFO - [0m12:55:46  8 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [RUN]
[2024-06-20T12:55:50.511+0000] {subprocess.py:93} INFO - [0m12:55:50  8 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [[32mSUCCESS 1[0m in 4.33s]
[2024-06-20T12:55:50.515+0000] {subprocess.py:93} INFO - [0m12:55:50
[2024-06-20T12:55:50.516+0000] {subprocess.py:93} INFO - [0m12:55:50  Finished running 4 view models, 4 table models in 0 hours 0 minutes and 15.24 seconds (15.24s).
[2024-06-20T12:55:50.700+0000] {subprocess.py:93} INFO - [0m12:55:50
[2024-06-20T12:55:50.700+0000] {subprocess.py:93} INFO - [0m12:55:50  [31mCompleted with 1 error and 0 warnings:[0m
[2024-06-20T12:55:50.701+0000] {subprocess.py:93} INFO - [0m12:55:50
[2024-06-20T12:55:50.702+0000] {subprocess.py:93} INFO - [0m12:55:50    Database Error in model transformed_nba_news (models/transformed/transformed_nba_news.sql)
[2024-06-20T12:55:50.702+0000] {subprocess.py:93} INFO -   000904 (42000): SQL compilation error: error line 9 at position 8
[2024-06-20T12:55:50.703+0000] {subprocess.py:93} INFO -   invalid identifier 'NEWS_SOURCE'
[2024-06-20T12:55:50.703+0000] {subprocess.py:93} INFO -   compiled Code at target/run/nba_project/models/transformed/transformed_nba_news.sql
[2024-06-20T12:55:50.706+0000] {subprocess.py:93} INFO - [0m12:55:50
[2024-06-20T12:55:50.706+0000] {subprocess.py:93} INFO - [0m12:55:50  Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[2024-06-20T12:55:51.389+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2024-06-20T12:55:51.390+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-06-20T12:55:51.418+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/operators/bash.py", line 243, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2024-06-20T12:55:51.423+0000] {taskinstance.py:1206} INFO - Marking task as UP_FOR_RETRY. dag_id=nba_data_pipeline_dag, task_id=dbt_run, run_id=scheduled__2024-06-18T00:00:00+00:00, execution_date=20240618T000000, start_date=20240620T125530, end_date=20240620T125551
[2024-06-20T12:55:51.437+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 1096 for task dbt_run (Bash command failed. The command returned a non-zero exit code 1.; 50994)
[2024-06-20T12:55:51.463+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2024-06-20T12:55:51.495+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-06-20T12:55:51.498+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-06-20T13:07:16.667+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-06-20T13:07:16.761+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T13:07:16.771+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T13:07:16.772+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2024-06-20T13:07:16.789+0000] {taskinstance.py:2330} INFO - Executing <Task(BashOperator): dbt_run> on 2024-06-18 00:00:00+00:00
[2024-06-20T13:07:16.810+0000] {logging_mixin.py:188} WARNING - /home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=57313) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2024-06-20T13:07:16.815+0000] {standard_task_runner.py:63} INFO - Started process 57392 to run task
[2024-06-20T13:07:16.813+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'nba_data_pipeline_dag', 'dbt_run', 'scheduled__2024-06-18T00:00:00+00:00', '--job-id', '1132', '--raw', '--subdir', 'DAGS_FOLDER/nba_data_pipeline_dag.py', '--cfg-path', '/tmp/tmp5dp1hgnc']
[2024-06-20T13:07:16.821+0000] {standard_task_runner.py:91} INFO - Job 1132: Subtask dbt_run
[2024-06-20T13:07:16.934+0000] {task_command.py:426} INFO - Running <TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [running]> on host ip-172-31-45-144.ec2.internal
[2024-06-20T13:07:17.100+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Airflow' AIRFLOW_CTX_DAG_ID='nba_data_pipeline_dag' AIRFLOW_CTX_TASK_ID='dbt_run' AIRFLOW_CTX_EXECUTION_DATE='2024-06-18T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-18T00:00:00+00:00'
[2024-06-20T13:07:17.102+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-06-20T13:07:17.121+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2024-06-20T13:07:17.122+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /home/ubuntu/nba_project && dbt run']
[2024-06-20T13:07:17.138+0000] {subprocess.py:86} INFO - Output:
[2024-06-20T13:07:19.449+0000] {subprocess.py:93} INFO - [0m13:07:19  Running with dbt=1.8.2
[2024-06-20T13:07:20.609+0000] {subprocess.py:93} INFO - [0m13:07:20  Registered adapter: snowflake=1.8.3
[2024-06-20T13:07:21.033+0000] {subprocess.py:93} INFO - [0m13:07:21  Found 8 models, 4 sources, 444 macros
[2024-06-20T13:07:21.036+0000] {subprocess.py:93} INFO - [0m13:07:21
[2024-06-20T13:07:34.428+0000] {subprocess.py:93} INFO - [0m13:07:34  Concurrency: 1 threads (target='dev')
[2024-06-20T13:07:34.430+0000] {subprocess.py:93} INFO - [0m13:07:34
[2024-06-20T13:07:34.435+0000] {subprocess.py:93} INFO - [0m13:07:34  1 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ........... [RUN]
[2024-06-20T13:07:35.185+0000] {subprocess.py:93} INFO - [0m13:07:35  1 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ...... [[32mSUCCESS 1[0m in 0.75s]
[2024-06-20T13:07:35.188+0000] {subprocess.py:93} INFO - [0m13:07:35  2 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores ......... [RUN]
[2024-06-20T13:07:36.000+0000] {subprocess.py:93} INFO - [0m13:07:35  2 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores .... [[32mSUCCESS 1[0m in 0.81s]
[2024-06-20T13:07:36.002+0000] {subprocess.py:93} INFO - [0m13:07:36  3 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_player_stats ....... [RUN]
[2024-06-20T13:07:36.772+0000] {subprocess.py:93} INFO - [0m13:07:36  3 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_player_stats .. [[32mSUCCESS 1[0m in 0.77s]
[2024-06-20T13:07:36.775+0000] {subprocess.py:93} INFO - [0m13:07:36  4 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [RUN]
[2024-06-20T13:07:37.670+0000] {subprocess.py:93} INFO - [0m13:07:37  4 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [[32mSUCCESS 1[0m in 0.89s]
[2024-06-20T13:07:37.673+0000] {subprocess.py:93} INFO - [0m13:07:37  5 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news ...... [RUN]
[2024-06-20T13:07:38.822+0000] {subprocess.py:93} INFO - [0m13:07:38  5 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news . [[32mSUCCESS 1[0m in 1.15s]
[2024-06-20T13:07:38.825+0000] {subprocess.py:93} INFO - [0m13:07:38  6 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores .... [RUN]
[2024-06-20T13:07:39.576+0000] {subprocess.py:93} INFO - [0m13:07:39  6 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores  [[32mSUCCESS 1[0m in 0.75s]
[2024-06-20T13:07:39.578+0000] {subprocess.py:93} INFO - [0m13:07:39  7 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats .. [RUN]
[2024-06-20T13:07:41.550+0000] {subprocess.py:93} INFO - [0m13:07:41  7 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats  [[32mSUCCESS 1[0m in 1.97s]
[2024-06-20T13:07:41.553+0000] {subprocess.py:93} INFO - [0m13:07:41  8 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [RUN]
[2024-06-20T13:07:43.060+0000] {subprocess.py:93} INFO - [0m13:07:43  8 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [[32mSUCCESS 1[0m in 1.50s]
[2024-06-20T13:07:43.064+0000] {subprocess.py:93} INFO - [0m13:07:43
[2024-06-20T13:07:43.064+0000] {subprocess.py:93} INFO - [0m13:07:43  Finished running 4 view models, 4 table models in 0 hours 0 minutes and 22.03 seconds (22.03s).
[2024-06-20T13:07:43.249+0000] {subprocess.py:93} INFO - [0m13:07:43
[2024-06-20T13:07:43.249+0000] {subprocess.py:93} INFO - [0m13:07:43  [32mCompleted successfully[0m
[2024-06-20T13:07:43.250+0000] {subprocess.py:93} INFO - [0m13:07:43
[2024-06-20T13:07:43.251+0000] {subprocess.py:93} INFO - [0m13:07:43  Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[2024-06-20T13:07:44.922+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2024-06-20T13:07:44.923+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-06-20T13:07:44.998+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=nba_data_pipeline_dag, task_id=dbt_run, run_id=scheduled__2024-06-18T00:00:00+00:00, execution_date=20240618T000000, start_date=20240620T130716, end_date=20240620T130744
[2024-06-20T13:07:45.038+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2024-06-20T13:07:45.077+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-06-20T13:07:45.079+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-06-20T17:41:40.899+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-06-20T17:41:40.941+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T17:41:40.949+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T17:41:40.949+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2024-06-20T17:41:40.961+0000] {taskinstance.py:2330} INFO - Executing <Task(BashOperator): dbt_run> on 2024-06-18 00:00:00+00:00
[2024-06-20T17:41:40.969+0000] {logging_mixin.py:188} WARNING - /home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=30005) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2024-06-20T17:41:40.970+0000] {standard_task_runner.py:63} INFO - Started process 30065 to run task
[2024-06-20T17:41:40.969+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'nba_data_pipeline_dag', 'dbt_run', 'scheduled__2024-06-18T00:00:00+00:00', '--job-id', '1293', '--raw', '--subdir', 'DAGS_FOLDER/nba_data_pipeline_dag.py', '--cfg-path', '/tmp/tmpkkccqtab']
[2024-06-20T17:41:40.971+0000] {standard_task_runner.py:91} INFO - Job 1293: Subtask dbt_run
[2024-06-20T17:41:41.059+0000] {task_command.py:426} INFO - Running <TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [running]> on host ip-172-31-45-144.ec2.internal
[2024-06-20T17:41:41.198+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Airflow' AIRFLOW_CTX_DAG_ID='nba_data_pipeline_dag' AIRFLOW_CTX_TASK_ID='dbt_run' AIRFLOW_CTX_EXECUTION_DATE='2024-06-18T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-18T00:00:00+00:00'
[2024-06-20T17:41:41.199+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-06-20T17:41:41.211+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2024-06-20T17:41:41.212+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /home/ubuntu/nba_project && dbt run']
[2024-06-20T17:41:41.223+0000] {subprocess.py:86} INFO - Output:
[2024-06-20T17:41:44.215+0000] {subprocess.py:93} INFO - [0m17:41:44  Running with dbt=1.8.2
[2024-06-20T17:41:45.274+0000] {subprocess.py:93} INFO - [0m17:41:45  Registered adapter: snowflake=1.8.3
[2024-06-20T17:41:46.205+0000] {subprocess.py:93} INFO - [0m17:41:46  Found 8 models, 4 sources, 444 macros
[2024-06-20T17:41:46.210+0000] {subprocess.py:93} INFO - [0m17:41:46
[2024-06-20T17:41:47.353+0000] {subprocess.py:93} INFO - [0m17:41:47  Concurrency: 1 threads (target='dev')
[2024-06-20T17:41:47.354+0000] {subprocess.py:93} INFO - [0m17:41:47
[2024-06-20T17:41:47.358+0000] {subprocess.py:93} INFO - [0m17:41:47  1 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ........... [RUN]
[2024-06-20T17:41:53.782+0000] {subprocess.py:93} INFO - [0m17:41:53  1 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ...... [[32mSUCCESS 1[0m in 6.42s]
[2024-06-20T17:41:53.784+0000] {subprocess.py:93} INFO - [0m17:41:53  2 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores ......... [RUN]
[2024-06-20T17:42:03.842+0000] {subprocess.py:93} INFO - [0m17:42:03  2 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores .... [[32mSUCCESS 1[0m in 10.06s]
[2024-06-20T17:42:03.845+0000] {subprocess.py:93} INFO - [0m17:42:03  3 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_player_stats ....... [RUN]
[2024-06-20T17:42:04.439+0000] {subprocess.py:93} INFO - [0m17:42:04  3 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_player_stats .. [[32mSUCCESS 1[0m in 0.59s]
[2024-06-20T17:42:04.441+0000] {subprocess.py:93} INFO - [0m17:42:04  4 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [RUN]
[2024-06-20T17:42:05.001+0000] {subprocess.py:93} INFO - [0m17:42:05  4 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [[32mSUCCESS 1[0m in 0.56s]
[2024-06-20T17:42:05.003+0000] {subprocess.py:93} INFO - [0m17:42:05  5 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news ...... [RUN]
[2024-06-20T17:42:06.327+0000] {subprocess.py:93} INFO - [0m17:42:06  5 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news . [[32mSUCCESS 1[0m in 1.32s]
[2024-06-20T17:42:06.330+0000] {subprocess.py:93} INFO - [0m17:42:06  6 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores .... [RUN]
[2024-06-20T17:42:07.453+0000] {subprocess.py:93} INFO - [0m17:42:07  6 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores  [[32mSUCCESS 1[0m in 1.12s]
[2024-06-20T17:42:07.455+0000] {subprocess.py:93} INFO - [0m17:42:07  7 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats .. [RUN]
[2024-06-20T17:42:07.905+0000] {subprocess.py:93} INFO - [0m17:42:07  7 of 8 ERROR creating sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats  [[31mERROR[0m in 0.45s]
[2024-06-20T17:42:07.908+0000] {subprocess.py:93} INFO - [0m17:42:07  8 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [RUN]
[2024-06-20T17:42:09.310+0000] {subprocess.py:93} INFO - [0m17:42:09  8 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [[32mSUCCESS 1[0m in 1.40s]
[2024-06-20T17:42:09.314+0000] {subprocess.py:93} INFO - [0m17:42:09
[2024-06-20T17:42:09.315+0000] {subprocess.py:93} INFO - [0m17:42:09  Finished running 4 view models, 4 table models in 0 hours 0 minutes and 23.10 seconds (23.10s).
[2024-06-20T17:42:09.356+0000] {subprocess.py:93} INFO - [0m17:42:09
[2024-06-20T17:42:09.357+0000] {subprocess.py:93} INFO - [0m17:42:09  [31mCompleted with 1 error and 0 warnings:[0m
[2024-06-20T17:42:09.357+0000] {subprocess.py:93} INFO - [0m17:42:09
[2024-06-20T17:42:09.358+0000] {subprocess.py:93} INFO - [0m17:42:09    Database Error in model transformed_player_stats (models/transformed/transformed_player_stats.sql)
[2024-06-20T17:42:09.358+0000] {subprocess.py:93} INFO -   002140 (42601): SQL compilation error:
[2024-06-20T17:42:09.358+0000] {subprocess.py:93} INFO -   Unknown function STRING_AGG
[2024-06-20T17:42:09.358+0000] {subprocess.py:93} INFO -   compiled Code at target/run/nba_project/models/transformed/transformed_player_stats.sql
[2024-06-20T17:42:09.359+0000] {subprocess.py:93} INFO - [0m17:42:09
[2024-06-20T17:42:09.359+0000] {subprocess.py:93} INFO - [0m17:42:09  Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[2024-06-20T17:42:09.805+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2024-06-20T17:42:09.806+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-06-20T17:42:09.831+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/operators/bash.py", line 243, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2024-06-20T17:42:09.835+0000] {taskinstance.py:1206} INFO - Marking task as UP_FOR_RETRY. dag_id=nba_data_pipeline_dag, task_id=dbt_run, run_id=scheduled__2024-06-18T00:00:00+00:00, execution_date=20240618T000000, start_date=20240620T174140, end_date=20240620T174209
[2024-06-20T17:42:09.848+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 1293 for task dbt_run (Bash command failed. The command returned a non-zero exit code 1.; 30065)
[2024-06-20T17:42:09.889+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2024-06-20T17:42:09.918+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-06-20T17:42:09.919+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-06-20T18:04:10.313+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-06-20T18:04:10.380+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T18:04:10.389+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T18:04:10.389+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2024-06-20T18:04:10.402+0000] {taskinstance.py:2330} INFO - Executing <Task(BashOperator): dbt_run> on 2024-06-18 00:00:00+00:00
[2024-06-20T18:04:10.410+0000] {logging_mixin.py:188} WARNING - /home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=37611) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2024-06-20T18:04:10.412+0000] {standard_task_runner.py:63} INFO - Started process 37704 to run task
[2024-06-20T18:04:10.411+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'nba_data_pipeline_dag', 'dbt_run', 'scheduled__2024-06-18T00:00:00+00:00', '--job-id', '1330', '--raw', '--subdir', 'DAGS_FOLDER/nba_data_pipeline_dag.py', '--cfg-path', '/tmp/tmp7xpxvfkf']
[2024-06-20T18:04:10.413+0000] {standard_task_runner.py:91} INFO - Job 1330: Subtask dbt_run
[2024-06-20T18:04:10.506+0000] {task_command.py:426} INFO - Running <TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [running]> on host ip-172-31-45-144.ec2.internal
[2024-06-20T18:04:10.645+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Airflow' AIRFLOW_CTX_DAG_ID='nba_data_pipeline_dag' AIRFLOW_CTX_TASK_ID='dbt_run' AIRFLOW_CTX_EXECUTION_DATE='2024-06-18T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-18T00:00:00+00:00'
[2024-06-20T18:04:10.646+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-06-20T18:04:10.659+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2024-06-20T18:04:10.660+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /home/ubuntu/nba_project && dbt run']
[2024-06-20T18:04:10.669+0000] {subprocess.py:86} INFO - Output:
[2024-06-20T18:04:12.608+0000] {subprocess.py:93} INFO - [0m18:04:12  Running with dbt=1.8.2
[2024-06-20T18:04:13.560+0000] {subprocess.py:93} INFO - [0m18:04:13  Registered adapter: snowflake=1.8.3
[2024-06-20T18:04:13.857+0000] {subprocess.py:93} INFO - [0m18:04:13  Found 8 models, 4 sources, 444 macros
[2024-06-20T18:04:13.860+0000] {subprocess.py:93} INFO - [0m18:04:13
[2024-06-20T18:04:14.781+0000] {subprocess.py:93} INFO - [0m18:04:14  Concurrency: 1 threads (target='dev')
[2024-06-20T18:04:14.781+0000] {subprocess.py:93} INFO - [0m18:04:14
[2024-06-20T18:04:14.785+0000] {subprocess.py:93} INFO - [0m18:04:14  1 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ........... [RUN]
[2024-06-20T18:04:15.622+0000] {subprocess.py:93} INFO - [0m18:04:15  1 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ...... [[32mSUCCESS 1[0m in 0.83s]
[2024-06-20T18:04:15.624+0000] {subprocess.py:93} INFO - [0m18:04:15  2 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores ......... [RUN]
[2024-06-20T18:04:16.067+0000] {subprocess.py:93} INFO - [0m18:04:16  2 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores .... [[32mSUCCESS 1[0m in 0.44s]
[2024-06-20T18:04:16.069+0000] {subprocess.py:93} INFO - [0m18:04:16  3 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_player_stats ....... [RUN]
[2024-06-20T18:04:16.676+0000] {subprocess.py:93} INFO - [0m18:04:16  3 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_player_stats .. [[32mSUCCESS 1[0m in 0.61s]
[2024-06-20T18:04:16.679+0000] {subprocess.py:93} INFO - [0m18:04:16  4 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [RUN]
[2024-06-20T18:04:17.284+0000] {subprocess.py:93} INFO - [0m18:04:17  4 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [[32mSUCCESS 1[0m in 0.60s]
[2024-06-20T18:04:17.286+0000] {subprocess.py:93} INFO - [0m18:04:17  5 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news ...... [RUN]
[2024-06-20T18:04:18.437+0000] {subprocess.py:93} INFO - [0m18:04:18  5 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news . [[32mSUCCESS 1[0m in 1.15s]
[2024-06-20T18:04:18.440+0000] {subprocess.py:93} INFO - [0m18:04:18  6 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores .... [RUN]
[2024-06-20T18:04:19.079+0000] {subprocess.py:93} INFO - [0m18:04:19  6 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores  [[32mSUCCESS 1[0m in 0.64s]
[2024-06-20T18:04:19.082+0000] {subprocess.py:93} INFO - [0m18:04:19  7 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats .. [RUN]
[2024-06-20T18:04:19.449+0000] {subprocess.py:93} INFO - [0m18:04:19  7 of 8 ERROR creating sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats  [[31mERROR[0m in 0.37s]
[2024-06-20T18:04:19.453+0000] {subprocess.py:93} INFO - [0m18:04:19  8 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [RUN]
[2024-06-20T18:04:19.798+0000] {subprocess.py:93} INFO - [0m18:04:19  8 of 8 ERROR creating sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [[31mERROR[0m in 0.34s]
[2024-06-20T18:04:19.802+0000] {subprocess.py:93} INFO - [0m18:04:19
[2024-06-20T18:04:19.802+0000] {subprocess.py:93} INFO - [0m18:04:19  Finished running 4 view models, 4 table models in 0 hours 0 minutes and 5.94 seconds (5.94s).
[2024-06-20T18:04:19.934+0000] {subprocess.py:93} INFO - [0m18:04:19
[2024-06-20T18:04:19.935+0000] {subprocess.py:93} INFO - [0m18:04:19  [31mCompleted with 2 errors and 0 warnings:[0m
[2024-06-20T18:04:19.935+0000] {subprocess.py:93} INFO - [0m18:04:19
[2024-06-20T18:04:19.936+0000] {subprocess.py:93} INFO - [0m18:04:19    Database Error in model transformed_player_stats (models/transformed/transformed_player_stats.sql)
[2024-06-20T18:04:19.936+0000] {subprocess.py:93} INFO -   001003 (42000): SQL compilation error:
[2024-06-20T18:04:19.936+0000] {subprocess.py:93} INFO -   syntax error line 96 at position 20 unexpected ';'.
[2024-06-20T18:04:19.936+0000] {subprocess.py:93} INFO -   compiled Code at target/run/nba_project/models/transformed/transformed_player_stats.sql
[2024-06-20T18:04:19.937+0000] {subprocess.py:93} INFO - [0m18:04:19
[2024-06-20T18:04:19.937+0000] {subprocess.py:93} INFO - [0m18:04:19    Database Error in model transformed_top_100_players_stats (models/transformed/transformed_top_100_players_stats.sql)
[2024-06-20T18:04:19.937+0000] {subprocess.py:93} INFO -   001003 (42000): SQL compilation error:
[2024-06-20T18:04:19.937+0000] {subprocess.py:93} INFO -   syntax error line 72 at position 17 unexpected ';'.
[2024-06-20T18:04:19.937+0000] {subprocess.py:93} INFO -   compiled Code at target/run/nba_project/models/transformed/transformed_top_100_players_stats.sql
[2024-06-20T18:04:19.938+0000] {subprocess.py:93} INFO - [0m18:04:19
[2024-06-20T18:04:19.939+0000] {subprocess.py:93} INFO - [0m18:04:19  Done. PASS=6 WARN=0 ERROR=2 SKIP=0 TOTAL=8
[2024-06-20T18:04:21.877+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2024-06-20T18:04:21.877+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-06-20T18:04:21.902+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/operators/bash.py", line 243, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2024-06-20T18:04:21.906+0000] {taskinstance.py:1206} INFO - Marking task as UP_FOR_RETRY. dag_id=nba_data_pipeline_dag, task_id=dbt_run, run_id=scheduled__2024-06-18T00:00:00+00:00, execution_date=20240618T000000, start_date=20240620T180410, end_date=20240620T180421
[2024-06-20T18:04:21.918+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 1330 for task dbt_run (Bash command failed. The command returned a non-zero exit code 1.; 37704)
[2024-06-20T18:04:21.938+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2024-06-20T18:04:21.966+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-06-20T18:04:21.967+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-06-20T18:08:13.765+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-06-20T18:08:13.807+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T18:08:13.815+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T18:08:13.816+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2024-06-20T18:08:13.830+0000] {taskinstance.py:2330} INFO - Executing <Task(BashOperator): dbt_run> on 2024-06-18 00:00:00+00:00
[2024-06-20T18:08:13.841+0000] {logging_mixin.py:188} WARNING - /home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=42466) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2024-06-20T18:08:13.845+0000] {standard_task_runner.py:63} INFO - Started process 42579 to run task
[2024-06-20T18:08:13.842+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'nba_data_pipeline_dag', 'dbt_run', 'scheduled__2024-06-18T00:00:00+00:00', '--job-id', '1363', '--raw', '--subdir', 'DAGS_FOLDER/nba_data_pipeline_dag.py', '--cfg-path', '/tmp/tmpb3qwy887']
[2024-06-20T18:08:13.847+0000] {standard_task_runner.py:91} INFO - Job 1363: Subtask dbt_run
[2024-06-20T18:08:13.942+0000] {task_command.py:426} INFO - Running <TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [running]> on host ip-172-31-45-144.ec2.internal
[2024-06-20T18:08:14.188+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Airflow' AIRFLOW_CTX_DAG_ID='nba_data_pipeline_dag' AIRFLOW_CTX_TASK_ID='dbt_run' AIRFLOW_CTX_EXECUTION_DATE='2024-06-18T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-18T00:00:00+00:00'
[2024-06-20T18:08:14.189+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-06-20T18:08:14.214+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2024-06-20T18:08:14.214+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /home/ubuntu/nba_project && dbt run']
[2024-06-20T18:08:14.225+0000] {subprocess.py:86} INFO - Output:
[2024-06-20T18:08:16.358+0000] {subprocess.py:93} INFO - [0m18:08:16  Running with dbt=1.8.2
[2024-06-20T18:08:17.334+0000] {subprocess.py:93} INFO - [0m18:08:17  Registered adapter: snowflake=1.8.3
[2024-06-20T18:08:18.123+0000] {subprocess.py:93} INFO - [0m18:08:18  Found 8 models, 4 sources, 444 macros
[2024-06-20T18:08:18.127+0000] {subprocess.py:93} INFO - [0m18:08:18
[2024-06-20T18:08:28.536+0000] {subprocess.py:93} INFO - [0m18:08:28  Concurrency: 1 threads (target='dev')
[2024-06-20T18:08:28.537+0000] {subprocess.py:93} INFO - [0m18:08:28
[2024-06-20T18:08:28.540+0000] {subprocess.py:93} INFO - [0m18:08:28  1 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ........... [RUN]
[2024-06-20T18:08:29.508+0000] {subprocess.py:93} INFO - [0m18:08:29  1 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ...... [[32mSUCCESS 1[0m in 0.96s]
[2024-06-20T18:08:29.510+0000] {subprocess.py:93} INFO - [0m18:08:29  2 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores ......... [RUN]
[2024-06-20T18:08:30.833+0000] {subprocess.py:93} INFO - [0m18:08:30  2 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores .... [[32mSUCCESS 1[0m in 1.32s]
[2024-06-20T18:08:30.835+0000] {subprocess.py:93} INFO - [0m18:08:30  3 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_player_stats ....... [RUN]
[2024-06-20T18:08:31.510+0000] {subprocess.py:93} INFO - [0m18:08:31  3 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_player_stats .. [[32mSUCCESS 1[0m in 0.67s]
[2024-06-20T18:08:31.513+0000] {subprocess.py:93} INFO - [0m18:08:31  4 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [RUN]
[2024-06-20T18:08:32.173+0000] {subprocess.py:93} INFO - [0m18:08:32  4 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [[32mSUCCESS 1[0m in 0.66s]
[2024-06-20T18:08:32.175+0000] {subprocess.py:93} INFO - [0m18:08:32  5 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news ...... [RUN]
[2024-06-20T18:08:34.194+0000] {subprocess.py:93} INFO - [0m18:08:34  5 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news . [[32mSUCCESS 1[0m in 2.02s]
[2024-06-20T18:08:34.196+0000] {subprocess.py:93} INFO - [0m18:08:34  6 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores .... [RUN]
[2024-06-20T18:08:35.122+0000] {subprocess.py:93} INFO - [0m18:08:35  6 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores  [[32mSUCCESS 1[0m in 0.92s]
[2024-06-20T18:08:35.124+0000] {subprocess.py:93} INFO - [0m18:08:35  7 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats .. [RUN]
[2024-06-20T18:08:35.522+0000] {subprocess.py:93} INFO - [0m18:08:35  7 of 8 ERROR creating sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats  [[31mERROR[0m in 0.40s]
[2024-06-20T18:08:35.526+0000] {subprocess.py:93} INFO - [0m18:08:35  8 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [RUN]
[2024-06-20T18:08:36.835+0000] {subprocess.py:93} INFO - [0m18:08:36  8 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [[32mSUCCESS 1[0m in 1.31s]
[2024-06-20T18:08:36.838+0000] {subprocess.py:93} INFO - [0m18:08:36
[2024-06-20T18:08:36.839+0000] {subprocess.py:93} INFO - [0m18:08:36  Finished running 4 view models, 4 table models in 0 hours 0 minutes and 18.71 seconds (18.71s).
[2024-06-20T18:08:36.879+0000] {subprocess.py:93} INFO - [0m18:08:36
[2024-06-20T18:08:36.879+0000] {subprocess.py:93} INFO - [0m18:08:36  [31mCompleted with 1 error and 0 warnings:[0m
[2024-06-20T18:08:36.880+0000] {subprocess.py:93} INFO - [0m18:08:36
[2024-06-20T18:08:36.880+0000] {subprocess.py:93} INFO - [0m18:08:36    Database Error in model transformed_player_stats (models/transformed/transformed_player_stats.sql)
[2024-06-20T18:08:36.881+0000] {subprocess.py:93} INFO -   001003 (42000): SQL compilation error:
[2024-06-20T18:08:36.881+0000] {subprocess.py:93} INFO -   syntax error line 96 at position 20 unexpected ';'.
[2024-06-20T18:08:36.881+0000] {subprocess.py:93} INFO -   compiled Code at target/run/nba_project/models/transformed/transformed_player_stats.sql
[2024-06-20T18:08:36.881+0000] {subprocess.py:93} INFO - [0m18:08:36
[2024-06-20T18:08:36.881+0000] {subprocess.py:93} INFO - [0m18:08:36  Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[2024-06-20T18:08:37.369+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2024-06-20T18:08:37.369+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-06-20T18:08:37.399+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/operators/bash.py", line 243, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2024-06-20T18:08:37.403+0000] {taskinstance.py:1206} INFO - Marking task as UP_FOR_RETRY. dag_id=nba_data_pipeline_dag, task_id=dbt_run, run_id=scheduled__2024-06-18T00:00:00+00:00, execution_date=20240618T000000, start_date=20240620T180813, end_date=20240620T180837
[2024-06-20T18:08:37.416+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 1363 for task dbt_run (Bash command failed. The command returned a non-zero exit code 1.; 42579)
[2024-06-20T18:08:37.449+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2024-06-20T18:08:37.478+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-06-20T18:08:37.481+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-06-20T18:13:00.523+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-06-20T18:13:00.567+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T18:13:00.575+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T18:13:00.576+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2024-06-20T18:13:00.587+0000] {taskinstance.py:2330} INFO - Executing <Task(BashOperator): dbt_run> on 2024-06-18 00:00:00+00:00
[2024-06-20T18:13:00.598+0000] {logging_mixin.py:188} WARNING - /home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=47298) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2024-06-20T18:13:00.600+0000] {standard_task_runner.py:63} INFO - Started process 47307 to run task
[2024-06-20T18:13:00.601+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'nba_data_pipeline_dag', 'dbt_run', 'scheduled__2024-06-18T00:00:00+00:00', '--job-id', '1398', '--raw', '--subdir', 'DAGS_FOLDER/nba_data_pipeline_dag.py', '--cfg-path', '/tmp/tmpx7x8g_vo']
[2024-06-20T18:13:00.603+0000] {standard_task_runner.py:91} INFO - Job 1398: Subtask dbt_run
[2024-06-20T18:13:00.701+0000] {task_command.py:426} INFO - Running <TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [running]> on host ip-172-31-45-144.ec2.internal
[2024-06-20T18:13:00.863+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Airflow' AIRFLOW_CTX_DAG_ID='nba_data_pipeline_dag' AIRFLOW_CTX_TASK_ID='dbt_run' AIRFLOW_CTX_EXECUTION_DATE='2024-06-18T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-18T00:00:00+00:00'
[2024-06-20T18:13:00.864+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-06-20T18:13:00.877+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2024-06-20T18:13:00.878+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /home/ubuntu/nba_project && dbt run']
[2024-06-20T18:13:00.891+0000] {subprocess.py:86} INFO - Output:
[2024-06-20T18:13:03.061+0000] {subprocess.py:93} INFO - [0m18:13:03  Running with dbt=1.8.2
[2024-06-20T18:13:04.134+0000] {subprocess.py:93} INFO - [0m18:13:04  Registered adapter: snowflake=1.8.3
[2024-06-20T18:13:04.449+0000] {subprocess.py:93} INFO - [0m18:13:04  Found 8 models, 4 sources, 444 macros
[2024-06-20T18:13:04.451+0000] {subprocess.py:93} INFO - [0m18:13:04
[2024-06-20T18:13:05.770+0000] {subprocess.py:93} INFO - [0m18:13:05  Concurrency: 1 threads (target='dev')
[2024-06-20T18:13:05.770+0000] {subprocess.py:93} INFO - [0m18:13:05
[2024-06-20T18:13:05.774+0000] {subprocess.py:93} INFO - [0m18:13:05  1 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ........... [RUN]
[2024-06-20T18:13:06.444+0000] {subprocess.py:93} INFO - [0m18:13:06  1 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ...... [[32mSUCCESS 1[0m in 0.67s]
[2024-06-20T18:13:06.447+0000] {subprocess.py:93} INFO - [0m18:13:06  2 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores ......... [RUN]
[2024-06-20T18:13:06.993+0000] {subprocess.py:93} INFO - [0m18:13:06  2 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores .... [[32mSUCCESS 1[0m in 0.54s]
[2024-06-20T18:13:06.995+0000] {subprocess.py:93} INFO - [0m18:13:06  3 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_player_stats ....... [RUN]
[2024-06-20T18:13:07.468+0000] {subprocess.py:93} INFO - [0m18:13:07  3 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_player_stats .. [[32mSUCCESS 1[0m in 0.47s]
[2024-06-20T18:13:07.471+0000] {subprocess.py:93} INFO - [0m18:13:07  4 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [RUN]
[2024-06-20T18:13:08.120+0000] {subprocess.py:93} INFO - [0m18:13:08  4 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [[32mSUCCESS 1[0m in 0.65s]
[2024-06-20T18:13:08.122+0000] {subprocess.py:93} INFO - [0m18:13:08  5 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news ...... [RUN]
[2024-06-20T18:13:09.238+0000] {subprocess.py:93} INFO - [0m18:13:09  5 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news . [[32mSUCCESS 1[0m in 1.11s]
[2024-06-20T18:13:09.241+0000] {subprocess.py:93} INFO - [0m18:13:09  6 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores .... [RUN]
[2024-06-20T18:13:10.369+0000] {subprocess.py:93} INFO - [0m18:13:10  6 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores  [[32mSUCCESS 1[0m in 1.13s]
[2024-06-20T18:13:10.371+0000] {subprocess.py:93} INFO - [0m18:13:10  7 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats .. [RUN]
[2024-06-20T18:13:10.844+0000] {subprocess.py:93} INFO - [0m18:13:10  7 of 8 ERROR creating sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats  [[31mERROR[0m in 0.47s]
[2024-06-20T18:13:10.847+0000] {subprocess.py:93} INFO - [0m18:13:10  8 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [RUN]
[2024-06-20T18:13:12.046+0000] {subprocess.py:93} INFO - [0m18:13:12  8 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [[32mSUCCESS 1[0m in 1.20s]
[2024-06-20T18:13:12.050+0000] {subprocess.py:93} INFO - [0m18:13:12
[2024-06-20T18:13:12.050+0000] {subprocess.py:93} INFO - [0m18:13:12  Finished running 4 view models, 4 table models in 0 hours 0 minutes and 7.60 seconds (7.60s).
[2024-06-20T18:13:12.184+0000] {subprocess.py:93} INFO - [0m18:13:12
[2024-06-20T18:13:12.184+0000] {subprocess.py:93} INFO - [0m18:13:12  [31mCompleted with 1 error and 0 warnings:[0m
[2024-06-20T18:13:12.185+0000] {subprocess.py:93} INFO - [0m18:13:12
[2024-06-20T18:13:12.186+0000] {subprocess.py:93} INFO - [0m18:13:12    Database Error in model transformed_player_stats (models/transformed/transformed_player_stats.sql)
[2024-06-20T18:13:12.186+0000] {subprocess.py:93} INFO -   002064 (42601): SQL compilation error:
[2024-06-20T18:13:12.186+0000] {subprocess.py:93} INFO -   Missing window specification for function [FIRST_VALUE(STAGING_PLAYER_STATS.PLAYER)].
[2024-06-20T18:13:12.186+0000] {subprocess.py:93} INFO -   compiled Code at target/run/nba_project/models/transformed/transformed_player_stats.sql
[2024-06-20T18:13:12.186+0000] {subprocess.py:93} INFO - [0m18:13:12
[2024-06-20T18:13:12.187+0000] {subprocess.py:93} INFO - [0m18:13:12  Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[2024-06-20T18:13:12.624+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2024-06-20T18:13:12.624+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-06-20T18:13:12.650+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/operators/bash.py", line 243, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2024-06-20T18:13:12.654+0000] {taskinstance.py:1206} INFO - Marking task as UP_FOR_RETRY. dag_id=nba_data_pipeline_dag, task_id=dbt_run, run_id=scheduled__2024-06-18T00:00:00+00:00, execution_date=20240618T000000, start_date=20240620T181300, end_date=20240620T181312
[2024-06-20T18:13:12.666+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 1398 for task dbt_run (Bash command failed. The command returned a non-zero exit code 1.; 47307)
[2024-06-20T18:13:12.677+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2024-06-20T18:13:12.705+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-06-20T18:13:12.706+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-06-20T18:19:01.776+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-06-20T18:19:01.817+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T18:19:01.826+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T18:19:01.826+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2024-06-20T18:19:01.839+0000] {taskinstance.py:2330} INFO - Executing <Task(BashOperator): dbt_run> on 2024-06-18 00:00:00+00:00
[2024-06-20T18:19:01.847+0000] {logging_mixin.py:188} WARNING - /home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=52706) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2024-06-20T18:19:01.849+0000] {standard_task_runner.py:63} INFO - Started process 52714 to run task
[2024-06-20T18:19:01.848+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'nba_data_pipeline_dag', 'dbt_run', 'scheduled__2024-06-18T00:00:00+00:00', '--job-id', '1433', '--raw', '--subdir', 'DAGS_FOLDER/nba_data_pipeline_dag.py', '--cfg-path', '/tmp/tmpog_15eoh']
[2024-06-20T18:19:01.850+0000] {standard_task_runner.py:91} INFO - Job 1433: Subtask dbt_run
[2024-06-20T18:19:01.942+0000] {task_command.py:426} INFO - Running <TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [running]> on host ip-172-31-45-144.ec2.internal
[2024-06-20T18:19:02.087+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Airflow' AIRFLOW_CTX_DAG_ID='nba_data_pipeline_dag' AIRFLOW_CTX_TASK_ID='dbt_run' AIRFLOW_CTX_EXECUTION_DATE='2024-06-18T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-18T00:00:00+00:00'
[2024-06-20T18:19:02.090+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-06-20T18:19:02.104+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2024-06-20T18:19:02.105+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /home/ubuntu/nba_project && dbt run']
[2024-06-20T18:19:02.118+0000] {subprocess.py:86} INFO - Output:
[2024-06-20T18:19:04.083+0000] {subprocess.py:93} INFO - [0m18:19:04  Running with dbt=1.8.2
[2024-06-20T18:19:05.128+0000] {subprocess.py:93} INFO - [0m18:19:05  Registered adapter: snowflake=1.8.3
[2024-06-20T18:19:05.519+0000] {subprocess.py:93} INFO - [0m18:19:05  Found 8 models, 4 sources, 444 macros
[2024-06-20T18:19:05.520+0000] {subprocess.py:93} INFO - [0m18:19:05
[2024-06-20T18:19:07.225+0000] {subprocess.py:93} INFO - [0m18:19:07  Concurrency: 1 threads (target='dev')
[2024-06-20T18:19:07.226+0000] {subprocess.py:93} INFO - [0m18:19:07
[2024-06-20T18:19:07.230+0000] {subprocess.py:93} INFO - [0m18:19:07  1 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ........... [RUN]
[2024-06-20T18:19:07.783+0000] {subprocess.py:93} INFO - [0m18:19:07  1 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ...... [[32mSUCCESS 1[0m in 0.55s]
[2024-06-20T18:19:07.786+0000] {subprocess.py:93} INFO - [0m18:19:07  2 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores ......... [RUN]
[2024-06-20T18:19:09.680+0000] {subprocess.py:93} INFO - [0m18:19:09  2 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores .... [[32mSUCCESS 1[0m in 1.89s]
[2024-06-20T18:19:09.683+0000] {subprocess.py:93} INFO - [0m18:19:09  3 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_player_stats ....... [RUN]
[2024-06-20T18:19:10.112+0000] {subprocess.py:93} INFO - [0m18:19:10  3 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_player_stats .. [[32mSUCCESS 1[0m in 0.43s]
[2024-06-20T18:19:10.114+0000] {subprocess.py:93} INFO - [0m18:19:10  4 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [RUN]
[2024-06-20T18:19:10.817+0000] {subprocess.py:93} INFO - [0m18:19:10  4 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [[32mSUCCESS 1[0m in 0.70s]
[2024-06-20T18:19:10.819+0000] {subprocess.py:93} INFO - [0m18:19:10  5 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news ...... [RUN]
[2024-06-20T18:19:14.453+0000] {subprocess.py:93} INFO - [0m18:19:14  5 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news . [[32mSUCCESS 1[0m in 3.63s]
[2024-06-20T18:19:14.455+0000] {subprocess.py:93} INFO - [0m18:19:14  6 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores .... [RUN]
[2024-06-20T18:19:15.275+0000] {subprocess.py:93} INFO - [0m18:19:15  6 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores  [[32mSUCCESS 1[0m in 0.82s]
[2024-06-20T18:19:15.278+0000] {subprocess.py:93} INFO - [0m18:19:15  7 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats .. [RUN]
[2024-06-20T18:19:15.786+0000] {subprocess.py:93} INFO - [0m18:19:15  7 of 8 ERROR creating sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats  [[31mERROR[0m in 0.51s]
[2024-06-20T18:19:15.789+0000] {subprocess.py:93} INFO - [0m18:19:15  8 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [RUN]
[2024-06-20T18:19:24.924+0000] {subprocess.py:93} INFO - [0m18:19:24  8 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [[32mSUCCESS 1[0m in 9.13s]
[2024-06-20T18:19:24.927+0000] {subprocess.py:93} INFO - [0m18:19:24
[2024-06-20T18:19:24.928+0000] {subprocess.py:93} INFO - [0m18:19:24  Finished running 4 view models, 4 table models in 0 hours 0 minutes and 19.41 seconds (19.41s).
[2024-06-20T18:19:25.056+0000] {subprocess.py:93} INFO - [0m18:19:25
[2024-06-20T18:19:25.057+0000] {subprocess.py:93} INFO - [0m18:19:25  [31mCompleted with 1 error and 0 warnings:[0m
[2024-06-20T18:19:25.057+0000] {subprocess.py:93} INFO - [0m18:19:25
[2024-06-20T18:19:25.058+0000] {subprocess.py:93} INFO - [0m18:19:25    Database Error in model transformed_player_stats (models/transformed/transformed_player_stats.sql)
[2024-06-20T18:19:25.058+0000] {subprocess.py:93} INFO -   002061 (42601): SQL compilation error:
[2024-06-20T18:19:25.058+0000] {subprocess.py:93} INFO -   Window function type [FIRST_VALUE] requires ORDER BY in window specification.
[2024-06-20T18:19:25.058+0000] {subprocess.py:93} INFO -   compiled Code at target/run/nba_project/models/transformed/transformed_player_stats.sql
[2024-06-20T18:19:25.059+0000] {subprocess.py:93} INFO - [0m18:19:25
[2024-06-20T18:19:25.059+0000] {subprocess.py:93} INFO - [0m18:19:25  Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[2024-06-20T18:19:25.566+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2024-06-20T18:19:25.566+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-06-20T18:19:25.591+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/operators/bash.py", line 243, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2024-06-20T18:19:25.596+0000] {taskinstance.py:1206} INFO - Marking task as UP_FOR_RETRY. dag_id=nba_data_pipeline_dag, task_id=dbt_run, run_id=scheduled__2024-06-18T00:00:00+00:00, execution_date=20240618T000000, start_date=20240620T181901, end_date=20240620T181925
[2024-06-20T18:19:25.611+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 1433 for task dbt_run (Bash command failed. The command returned a non-zero exit code 1.; 52714)
[2024-06-20T18:19:25.643+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2024-06-20T18:19:25.671+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-06-20T18:19:25.673+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-06-20T18:24:40.746+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-06-20T18:24:40.789+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T18:24:40.800+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T18:24:40.800+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2024-06-20T18:24:40.824+0000] {taskinstance.py:2330} INFO - Executing <Task(BashOperator): dbt_run> on 2024-06-18 00:00:00+00:00
[2024-06-20T18:24:40.837+0000] {logging_mixin.py:188} WARNING - /home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=58298) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2024-06-20T18:24:40.840+0000] {standard_task_runner.py:63} INFO - Started process 58316 to run task
[2024-06-20T18:24:40.836+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'nba_data_pipeline_dag', 'dbt_run', 'scheduled__2024-06-18T00:00:00+00:00', '--job-id', '1469', '--raw', '--subdir', 'DAGS_FOLDER/nba_data_pipeline_dag.py', '--cfg-path', '/tmp/tmpmd8apo9v']
[2024-06-20T18:24:40.841+0000] {standard_task_runner.py:91} INFO - Job 1469: Subtask dbt_run
[2024-06-20T18:24:40.981+0000] {task_command.py:426} INFO - Running <TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [running]> on host ip-172-31-45-144.ec2.internal
[2024-06-20T18:24:41.150+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Airflow' AIRFLOW_CTX_DAG_ID='nba_data_pipeline_dag' AIRFLOW_CTX_TASK_ID='dbt_run' AIRFLOW_CTX_EXECUTION_DATE='2024-06-18T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-18T00:00:00+00:00'
[2024-06-20T18:24:41.151+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-06-20T18:24:41.164+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2024-06-20T18:24:41.164+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /home/ubuntu/nba_project && dbt run']
[2024-06-20T18:24:41.174+0000] {subprocess.py:86} INFO - Output:
[2024-06-20T18:24:43.250+0000] {subprocess.py:93} INFO - [0m18:24:43  Running with dbt=1.8.2
[2024-06-20T18:24:44.242+0000] {subprocess.py:93} INFO - [0m18:24:44  Registered adapter: snowflake=1.8.3
[2024-06-20T18:24:45.015+0000] {subprocess.py:93} INFO - [0m18:24:45  Found 8 models, 4 sources, 444 macros
[2024-06-20T18:24:45.019+0000] {subprocess.py:93} INFO - [0m18:24:45
[2024-06-20T18:24:46.310+0000] {subprocess.py:93} INFO - [0m18:24:46  Concurrency: 1 threads (target='dev')
[2024-06-20T18:24:46.311+0000] {subprocess.py:93} INFO - [0m18:24:46
[2024-06-20T18:24:46.316+0000] {subprocess.py:93} INFO - [0m18:24:46  1 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ........... [RUN]
[2024-06-20T18:24:46.930+0000] {subprocess.py:93} INFO - [0m18:24:46  1 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ...... [[32mSUCCESS 1[0m in 0.61s]
[2024-06-20T18:24:46.933+0000] {subprocess.py:93} INFO - [0m18:24:46  2 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores ......... [RUN]
[2024-06-20T18:24:47.946+0000] {subprocess.py:93} INFO - [0m18:24:47  2 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores .... [[32mSUCCESS 1[0m in 1.01s]
[2024-06-20T18:24:47.950+0000] {subprocess.py:93} INFO - [0m18:24:47  3 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_player_stats ....... [RUN]
[2024-06-20T18:24:48.358+0000] {subprocess.py:93} INFO - [0m18:24:48  3 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_player_stats .. [[32mSUCCESS 1[0m in 0.41s]
[2024-06-20T18:24:48.361+0000] {subprocess.py:93} INFO - [0m18:24:48  4 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [RUN]
[2024-06-20T18:24:48.769+0000] {subprocess.py:93} INFO - [0m18:24:48  4 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [[32mSUCCESS 1[0m in 0.41s]
[2024-06-20T18:24:48.772+0000] {subprocess.py:93} INFO - [0m18:24:48  5 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news ...... [RUN]
[2024-06-20T18:24:49.592+0000] {subprocess.py:93} INFO - [0m18:24:49  5 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news . [[32mSUCCESS 1[0m in 0.82s]
[2024-06-20T18:24:49.595+0000] {subprocess.py:93} INFO - [0m18:24:49  6 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores .... [RUN]
[2024-06-20T18:24:50.509+0000] {subprocess.py:93} INFO - [0m18:24:50  6 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores  [[32mSUCCESS 1[0m in 0.91s]
[2024-06-20T18:24:50.514+0000] {subprocess.py:93} INFO - [0m18:24:50  7 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats .. [RUN]
[2024-06-20T18:24:51.044+0000] {subprocess.py:93} INFO - [0m18:24:51  7 of 8 ERROR creating sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats  [[31mERROR[0m in 0.53s]
[2024-06-20T18:24:51.051+0000] {subprocess.py:93} INFO - [0m18:24:51  8 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [RUN]
[2024-06-20T18:24:52.676+0000] {subprocess.py:93} INFO - [0m18:24:52  8 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [[32mSUCCESS 1[0m in 1.63s]
[2024-06-20T18:24:52.680+0000] {subprocess.py:93} INFO - [0m18:24:52
[2024-06-20T18:24:52.681+0000] {subprocess.py:93} INFO - [0m18:24:52  Finished running 4 view models, 4 table models in 0 hours 0 minutes and 7.66 seconds (7.66s).
[2024-06-20T18:24:52.722+0000] {subprocess.py:93} INFO - [0m18:24:52
[2024-06-20T18:24:52.722+0000] {subprocess.py:93} INFO - [0m18:24:52  [31mCompleted with 1 error and 0 warnings:[0m
[2024-06-20T18:24:52.723+0000] {subprocess.py:93} INFO - [0m18:24:52
[2024-06-20T18:24:52.723+0000] {subprocess.py:93} INFO - [0m18:24:52    Database Error in model transformed_player_stats (models/transformed/transformed_player_stats.sql)
[2024-06-20T18:24:52.723+0000] {subprocess.py:93} INFO -   001104 (42601): SQL compilation error: error line 7 at position 8
[2024-06-20T18:24:52.724+0000] {subprocess.py:93} INFO -   'STAGING_PLAYER_STATS.PLAYER' in select clause is neither an aggregate nor in the group by clause.
[2024-06-20T18:24:52.724+0000] {subprocess.py:93} INFO -   compiled Code at target/run/nba_project/models/transformed/transformed_player_stats.sql
[2024-06-20T18:24:52.724+0000] {subprocess.py:93} INFO - [0m18:24:52
[2024-06-20T18:24:52.725+0000] {subprocess.py:93} INFO - [0m18:24:52  Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[2024-06-20T18:24:53.238+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2024-06-20T18:24:53.239+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-06-20T18:24:53.266+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/operators/bash.py", line 243, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2024-06-20T18:24:53.271+0000] {taskinstance.py:1206} INFO - Marking task as UP_FOR_RETRY. dag_id=nba_data_pipeline_dag, task_id=dbt_run, run_id=scheduled__2024-06-18T00:00:00+00:00, execution_date=20240618T000000, start_date=20240620T182440, end_date=20240620T182453
[2024-06-20T18:24:53.286+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 1469 for task dbt_run (Bash command failed. The command returned a non-zero exit code 1.; 58316)
[2024-06-20T18:24:53.321+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2024-06-20T18:24:53.351+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-06-20T18:24:53.353+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-06-20T18:31:30.132+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-06-20T18:31:30.176+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T18:31:30.184+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T18:31:30.185+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2024-06-20T18:31:30.198+0000] {taskinstance.py:2330} INFO - Executing <Task(BashOperator): dbt_run> on 2024-06-18 00:00:00+00:00
[2024-06-20T18:31:30.211+0000] {logging_mixin.py:188} WARNING - /home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=67356) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2024-06-20T18:31:30.213+0000] {standard_task_runner.py:63} INFO - Started process 67374 to run task
[2024-06-20T18:31:30.213+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'nba_data_pipeline_dag', 'dbt_run', 'scheduled__2024-06-18T00:00:00+00:00', '--job-id', '1535', '--raw', '--subdir', 'DAGS_FOLDER/nba_data_pipeline_dag.py', '--cfg-path', '/tmp/tmpkva3req1']
[2024-06-20T18:31:30.215+0000] {standard_task_runner.py:91} INFO - Job 1535: Subtask dbt_run
[2024-06-20T18:31:30.332+0000] {task_command.py:426} INFO - Running <TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [running]> on host ip-172-31-45-144.ec2.internal
[2024-06-20T18:31:30.531+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Airflow' AIRFLOW_CTX_DAG_ID='nba_data_pipeline_dag' AIRFLOW_CTX_TASK_ID='dbt_run' AIRFLOW_CTX_EXECUTION_DATE='2024-06-18T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-18T00:00:00+00:00'
[2024-06-20T18:31:30.532+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-06-20T18:31:30.545+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2024-06-20T18:31:30.546+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /home/ubuntu/nba_project && dbt run']
[2024-06-20T18:31:30.557+0000] {subprocess.py:86} INFO - Output:
[2024-06-20T18:31:32.698+0000] {subprocess.py:93} INFO - [0m18:31:32  Running with dbt=1.8.2
[2024-06-20T18:31:33.722+0000] {subprocess.py:93} INFO - [0m18:31:33  Registered adapter: snowflake=1.8.3
[2024-06-20T18:31:34.486+0000] {subprocess.py:93} INFO - [0m18:31:34  Found 8 models, 4 sources, 444 macros
[2024-06-20T18:31:34.491+0000] {subprocess.py:93} INFO - [0m18:31:34
[2024-06-20T18:31:35.845+0000] {subprocess.py:93} INFO - [0m18:31:35  Concurrency: 1 threads (target='dev')
[2024-06-20T18:31:35.846+0000] {subprocess.py:93} INFO - [0m18:31:35
[2024-06-20T18:31:35.849+0000] {subprocess.py:93} INFO - [0m18:31:35  1 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ........... [RUN]
[2024-06-20T18:31:36.460+0000] {subprocess.py:93} INFO - [0m18:31:36  1 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ...... [[32mSUCCESS 1[0m in 0.60s]
[2024-06-20T18:31:36.463+0000] {subprocess.py:93} INFO - [0m18:31:36  2 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores ......... [RUN]
[2024-06-20T18:31:37.355+0000] {subprocess.py:93} INFO - [0m18:31:37  2 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores .... [[32mSUCCESS 1[0m in 0.89s]
[2024-06-20T18:31:37.357+0000] {subprocess.py:93} INFO - [0m18:31:37  3 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_player_stats ....... [RUN]
[2024-06-20T18:31:37.880+0000] {subprocess.py:93} INFO - [0m18:31:37  3 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_player_stats .. [[32mSUCCESS 1[0m in 0.52s]
[2024-06-20T18:31:37.883+0000] {subprocess.py:93} INFO - [0m18:31:37  4 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [RUN]
[2024-06-20T18:31:38.410+0000] {subprocess.py:93} INFO - [0m18:31:38  4 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [[32mSUCCESS 1[0m in 0.52s]
[2024-06-20T18:31:38.412+0000] {subprocess.py:93} INFO - [0m18:31:38  5 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news ...... [RUN]
[2024-06-20T18:31:39.308+0000] {subprocess.py:93} INFO - [0m18:31:39  5 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news . [[32mSUCCESS 1[0m in 0.89s]
[2024-06-20T18:31:39.312+0000] {subprocess.py:93} INFO - [0m18:31:39  6 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores .... [RUN]
[2024-06-20T18:31:40.040+0000] {subprocess.py:93} INFO - [0m18:31:40  6 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores  [[32mSUCCESS 1[0m in 0.73s]
[2024-06-20T18:31:40.042+0000] {subprocess.py:93} INFO - [0m18:31:40  7 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats .. [RUN]
[2024-06-20T18:31:40.535+0000] {subprocess.py:93} INFO - [0m18:31:40  7 of 8 ERROR creating sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats  [[31mERROR[0m in 0.49s]
[2024-06-20T18:31:40.539+0000] {subprocess.py:93} INFO - [0m18:31:40  8 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [RUN]
[2024-06-20T18:31:41.448+0000] {subprocess.py:93} INFO - [0m18:31:41  8 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [[32mSUCCESS 1[0m in 0.91s]
[2024-06-20T18:31:41.452+0000] {subprocess.py:93} INFO - [0m18:31:41
[2024-06-20T18:31:41.453+0000] {subprocess.py:93} INFO - [0m18:31:41  Finished running 4 view models, 4 table models in 0 hours 0 minutes and 6.96 seconds (6.96s).
[2024-06-20T18:31:41.504+0000] {subprocess.py:93} INFO - [0m18:31:41
[2024-06-20T18:31:41.506+0000] {subprocess.py:93} INFO - [0m18:31:41  [31mCompleted with 1 error and 0 warnings:[0m
[2024-06-20T18:31:41.508+0000] {subprocess.py:93} INFO - [0m18:31:41
[2024-06-20T18:31:41.509+0000] {subprocess.py:93} INFO - [0m18:31:41    Database Error in model transformed_player_stats (models/transformed/transformed_player_stats.sql)
[2024-06-20T18:31:41.509+0000] {subprocess.py:93} INFO -   000979 (42601): SQL compilation error:
[2024-06-20T18:31:41.509+0000] {subprocess.py:93} INFO -   [STAGING_PLAYER_STATS.PLAYER] is not a valid group by expression
[2024-06-20T18:31:41.509+0000] {subprocess.py:93} INFO -   compiled Code at target/run/nba_project/models/transformed/transformed_player_stats.sql
[2024-06-20T18:31:41.511+0000] {subprocess.py:93} INFO - [0m18:31:41
[2024-06-20T18:31:41.511+0000] {subprocess.py:93} INFO - [0m18:31:41  Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[2024-06-20T18:31:42.228+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2024-06-20T18:31:42.229+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-06-20T18:31:42.254+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/airflow/operators/bash.py", line 243, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2024-06-20T18:31:42.259+0000] {taskinstance.py:1206} INFO - Marking task as UP_FOR_RETRY. dag_id=nba_data_pipeline_dag, task_id=dbt_run, run_id=scheduled__2024-06-18T00:00:00+00:00, execution_date=20240618T000000, start_date=20240620T183130, end_date=20240620T183142
[2024-06-20T18:31:42.271+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 1535 for task dbt_run (Bash command failed. The command returned a non-zero exit code 1.; 67374)
[2024-06-20T18:31:42.300+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2024-06-20T18:31:42.329+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-06-20T18:31:42.331+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-06-20T18:38:39.498+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-06-20T18:38:39.540+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T18:38:39.549+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T18:38:39.549+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2024-06-20T18:38:39.561+0000] {taskinstance.py:2330} INFO - Executing <Task(BashOperator): dbt_run> on 2024-06-18 00:00:00+00:00
[2024-06-20T18:38:39.576+0000] {logging_mixin.py:188} WARNING - /home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=73159) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2024-06-20T18:38:39.579+0000] {standard_task_runner.py:63} INFO - Started process 73259 to run task
[2024-06-20T18:38:39.577+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'nba_data_pipeline_dag', 'dbt_run', 'scheduled__2024-06-18T00:00:00+00:00', '--job-id', '1571', '--raw', '--subdir', 'DAGS_FOLDER/nba_data_pipeline_dag.py', '--cfg-path', '/tmp/tmp69jb6h5s']
[2024-06-20T18:38:39.580+0000] {standard_task_runner.py:91} INFO - Job 1571: Subtask dbt_run
[2024-06-20T18:38:39.678+0000] {task_command.py:426} INFO - Running <TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [running]> on host ip-172-31-45-144.ec2.internal
[2024-06-20T18:38:39.842+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Airflow' AIRFLOW_CTX_DAG_ID='nba_data_pipeline_dag' AIRFLOW_CTX_TASK_ID='dbt_run' AIRFLOW_CTX_EXECUTION_DATE='2024-06-18T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-18T00:00:00+00:00'
[2024-06-20T18:38:39.843+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-06-20T18:38:39.858+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2024-06-20T18:38:39.859+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /home/ubuntu/nba_project && dbt run']
[2024-06-20T18:38:39.871+0000] {subprocess.py:86} INFO - Output:
[2024-06-20T18:38:41.949+0000] {subprocess.py:93} INFO - [0m18:38:41  Running with dbt=1.8.2
[2024-06-20T18:38:42.972+0000] {subprocess.py:93} INFO - [0m18:38:42  Registered adapter: snowflake=1.8.3
[2024-06-20T18:38:43.760+0000] {subprocess.py:93} INFO - [0m18:38:43  Found 8 models, 4 sources, 444 macros
[2024-06-20T18:38:43.766+0000] {subprocess.py:93} INFO - [0m18:38:43
[2024-06-20T18:38:47.635+0000] {subprocess.py:93} INFO - [0m18:38:47  Concurrency: 1 threads (target='dev')
[2024-06-20T18:38:47.635+0000] {subprocess.py:93} INFO - [0m18:38:47
[2024-06-20T18:38:47.638+0000] {subprocess.py:93} INFO - [0m18:38:47  1 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ........... [RUN]
[2024-06-20T18:38:48.322+0000] {subprocess.py:93} INFO - [0m18:38:48  1 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ...... [[32mSUCCESS 1[0m in 0.68s]
[2024-06-20T18:38:48.325+0000] {subprocess.py:93} INFO - [0m18:38:48  2 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores ......... [RUN]
[2024-06-20T18:38:48.906+0000] {subprocess.py:93} INFO - [0m18:38:48  2 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores .... [[32mSUCCESS 1[0m in 0.58s]
[2024-06-20T18:38:48.908+0000] {subprocess.py:93} INFO - [0m18:38:48  3 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_player_stats ....... [RUN]
[2024-06-20T18:38:49.348+0000] {subprocess.py:93} INFO - [0m18:38:49  3 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_player_stats .. [[32mSUCCESS 1[0m in 0.44s]
[2024-06-20T18:38:49.351+0000] {subprocess.py:93} INFO - [0m18:38:49  4 of 8 START sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [RUN]
[2024-06-20T18:38:49.764+0000] {subprocess.py:93} INFO - [0m18:38:49  4 of 8 OK created sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [[32mSUCCESS 1[0m in 0.41s]
[2024-06-20T18:38:49.772+0000] {subprocess.py:93} INFO - [0m18:38:49  5 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news ...... [RUN]
[2024-06-20T18:38:54.115+0000] {subprocess.py:93} INFO - [0m18:38:54  5 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news . [[32mSUCCESS 1[0m in 4.34s]
[2024-06-20T18:38:54.118+0000] {subprocess.py:93} INFO - [0m18:38:54  6 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores .... [RUN]
[2024-06-20T18:38:54.897+0000] {subprocess.py:93} INFO - [0m18:38:54  6 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores  [[32mSUCCESS 1[0m in 0.78s]
[2024-06-20T18:38:54.899+0000] {subprocess.py:93} INFO - [0m18:38:54  7 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats .. [RUN]
[2024-06-20T18:38:55.905+0000] {subprocess.py:93} INFO - [0m18:38:55  7 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats  [[32mSUCCESS 1[0m in 1.00s]
[2024-06-20T18:38:55.908+0000] {subprocess.py:93} INFO - [0m18:38:55  8 of 8 START sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [RUN]
[2024-06-20T18:38:56.889+0000] {subprocess.py:93} INFO - [0m18:38:56  8 of 8 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [[32mSUCCESS 1[0m in 0.98s]
[2024-06-20T18:38:56.894+0000] {subprocess.py:93} INFO - [0m18:38:56
[2024-06-20T18:38:56.895+0000] {subprocess.py:93} INFO - [0m18:38:56  Finished running 4 view models, 4 table models in 0 hours 0 minutes and 13.13 seconds (13.13s).
[2024-06-20T18:38:56.937+0000] {subprocess.py:93} INFO - [0m18:38:56
[2024-06-20T18:38:56.937+0000] {subprocess.py:93} INFO - [0m18:38:56  [32mCompleted successfully[0m
[2024-06-20T18:38:56.938+0000] {subprocess.py:93} INFO - [0m18:38:56
[2024-06-20T18:38:56.938+0000] {subprocess.py:93} INFO - [0m18:38:56  Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[2024-06-20T18:38:57.428+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2024-06-20T18:38:57.429+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-06-20T18:38:57.486+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=nba_data_pipeline_dag, task_id=dbt_run, run_id=scheduled__2024-06-18T00:00:00+00:00, execution_date=20240618T000000, start_date=20240620T183839, end_date=20240620T183857
[2024-06-20T18:38:57.534+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2024-06-20T18:38:57.564+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-06-20T18:38:57.568+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-06-20T21:20:21.560+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-06-20T21:20:21.608+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T21:20:21.618+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T21:20:21.618+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2024-06-20T21:20:21.637+0000] {taskinstance.py:2330} INFO - Executing <Task(BashOperator): dbt_run> on 2024-06-18 00:00:00+00:00
[2024-06-20T21:20:21.649+0000] {logging_mixin.py:188} WARNING - /home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=5705) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2024-06-20T21:20:21.654+0000] {standard_task_runner.py:63} INFO - Started process 5720 to run task
[2024-06-20T21:20:21.651+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'nba_data_pipeline_dag', 'dbt_run', 'scheduled__2024-06-18T00:00:00+00:00', '--job-id', '1606', '--raw', '--subdir', 'DAGS_FOLDER/nba_data_pipeline_dag.py', '--cfg-path', '/tmp/tmpk824_sk7']
[2024-06-20T21:20:21.656+0000] {standard_task_runner.py:91} INFO - Job 1606: Subtask dbt_run
[2024-06-20T21:20:21.756+0000] {task_command.py:426} INFO - Running <TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [running]> on host ip-172-31-45-144.ec2.internal
[2024-06-20T21:20:21.917+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Airflow' AIRFLOW_CTX_DAG_ID='nba_data_pipeline_dag' AIRFLOW_CTX_TASK_ID='dbt_run' AIRFLOW_CTX_EXECUTION_DATE='2024-06-18T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-18T00:00:00+00:00'
[2024-06-20T21:20:21.918+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-06-20T21:20:21.931+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2024-06-20T21:20:21.932+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /home/ubuntu/nba_project && dbt run']
[2024-06-20T21:20:21.944+0000] {subprocess.py:86} INFO - Output:
[2024-06-20T21:20:24.282+0000] {subprocess.py:93} INFO - [0m21:20:24  Running with dbt=1.8.2
[2024-06-20T21:20:25.450+0000] {subprocess.py:93} INFO - [0m21:20:25  Registered adapter: snowflake=1.8.3
[2024-06-20T21:20:25.644+0000] {subprocess.py:93} INFO - [0m21:20:25  Unable to do partial parsing because a project config has changed
[2024-06-20T21:20:27.836+0000] {subprocess.py:93} INFO - [0m21:20:27  Found 9 models, 4 sources, 444 macros
[2024-06-20T21:20:27.841+0000] {subprocess.py:93} INFO - [0m21:20:27
[2024-06-20T21:20:30.712+0000] {subprocess.py:93} INFO - [0m21:20:30  Concurrency: 1 threads (target='dev')
[2024-06-20T21:20:30.713+0000] {subprocess.py:93} INFO - [0m21:20:30
[2024-06-20T21:20:30.717+0000] {subprocess.py:93} INFO - [0m21:20:30  1 of 9 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ........... [RUN]
[2024-06-20T21:20:31.400+0000] {subprocess.py:93} INFO - [0m21:20:31  1 of 9 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ...... [[32mSUCCESS 1[0m in 0.68s]
[2024-06-20T21:20:31.403+0000] {subprocess.py:93} INFO - [0m21:20:31  2 of 9 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores ......... [RUN]
[2024-06-20T21:20:32.023+0000] {subprocess.py:93} INFO - [0m21:20:32  2 of 9 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores .... [[32mSUCCESS 1[0m in 0.62s]
[2024-06-20T21:20:32.024+0000] {subprocess.py:93} INFO - [0m21:20:32  3 of 9 START sql view model NBA_STATS_dbt_nba_stats.staging_player_stats ....... [RUN]
[2024-06-20T21:20:32.531+0000] {subprocess.py:93} INFO - [0m21:20:32  3 of 9 OK created sql view model NBA_STATS_dbt_nba_stats.staging_player_stats .. [[32mSUCCESS 1[0m in 0.50s]
[2024-06-20T21:20:32.534+0000] {subprocess.py:93} INFO - [0m21:20:32  4 of 9 START sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [RUN]
[2024-06-20T21:20:33.017+0000] {subprocess.py:93} INFO - [0m21:20:33  4 of 9 OK created sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [[32mSUCCESS 1[0m in 0.48s]
[2024-06-20T21:20:33.019+0000] {subprocess.py:93} INFO - [0m21:20:33  5 of 9 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news ...... [RUN]
[2024-06-20T21:20:34.520+0000] {subprocess.py:93} INFO - [0m21:20:34  5 of 9 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news . [[32mSUCCESS 1[0m in 1.50s]
[2024-06-20T21:20:34.522+0000] {subprocess.py:93} INFO - [0m21:20:34  6 of 9 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores .... [RUN]
[2024-06-20T21:20:35.488+0000] {subprocess.py:93} INFO - [0m21:20:35  6 of 9 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores  [[32mSUCCESS 1[0m in 0.96s]
[2024-06-20T21:20:35.492+0000] {subprocess.py:93} INFO - [0m21:20:35  7 of 9 START sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats .. [RUN]
[2024-06-20T21:20:37.798+0000] {subprocess.py:93} INFO - [0m21:20:37  7 of 9 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats  [[32mSUCCESS 1[0m in 2.30s]
[2024-06-20T21:20:37.801+0000] {subprocess.py:93} INFO - [0m21:20:37  8 of 9 START sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [RUN]
[2024-06-20T21:20:39.079+0000] {subprocess.py:93} INFO - [0m21:20:39  8 of 9 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [[32mSUCCESS 1[0m in 1.28s]
[2024-06-20T21:20:39.084+0000] {subprocess.py:93} INFO - [0m21:20:39  9 of 9 START sql table model NBA_STATS_dbt_nba_stats.top_100_all_time .......... [RUN]
[2024-06-20T21:20:40.331+0000] {subprocess.py:93} INFO - [0m21:20:40  9 of 9 OK created sql table model NBA_STATS_dbt_nba_stats.top_100_all_time ..... [[32mSUCCESS 1[0m in 1.24s]
[2024-06-20T21:20:40.334+0000] {subprocess.py:93} INFO - [0m21:20:40
[2024-06-20T21:20:40.335+0000] {subprocess.py:93} INFO - [0m21:20:40  Finished running 4 view models, 5 table models in 0 hours 0 minutes and 12.49 seconds (12.49s).
[2024-06-20T21:20:40.376+0000] {subprocess.py:93} INFO - [0m21:20:40
[2024-06-20T21:20:40.377+0000] {subprocess.py:93} INFO - [0m21:20:40  [32mCompleted successfully[0m
[2024-06-20T21:20:40.378+0000] {subprocess.py:93} INFO - [0m21:20:40
[2024-06-20T21:20:40.378+0000] {subprocess.py:93} INFO - [0m21:20:40  Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[2024-06-20T21:20:40.975+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2024-06-20T21:20:40.976+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-06-20T21:20:41.038+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=nba_data_pipeline_dag, task_id=dbt_run, run_id=scheduled__2024-06-18T00:00:00+00:00, execution_date=20240618T000000, start_date=20240620T212021, end_date=20240620T212041
[2024-06-20T21:20:41.103+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2024-06-20T21:20:41.133+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-06-20T21:20:41.135+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-06-20T21:25:51.650+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-06-20T21:25:51.710+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T21:25:51.724+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T21:25:51.725+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2024-06-20T21:25:51.739+0000] {taskinstance.py:2330} INFO - Executing <Task(BashOperator): dbt_run> on 2024-06-18 00:00:00+00:00
[2024-06-20T21:25:51.754+0000] {logging_mixin.py:188} WARNING - /home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=10349) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2024-06-20T21:25:51.758+0000] {standard_task_runner.py:63} INFO - Started process 10448 to run task
[2024-06-20T21:25:51.756+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'nba_data_pipeline_dag', 'dbt_run', 'scheduled__2024-06-18T00:00:00+00:00', '--job-id', '1639', '--raw', '--subdir', 'DAGS_FOLDER/nba_data_pipeline_dag.py', '--cfg-path', '/tmp/tmp73jvqcyr']
[2024-06-20T21:25:51.760+0000] {standard_task_runner.py:91} INFO - Job 1639: Subtask dbt_run
[2024-06-20T21:25:51.887+0000] {task_command.py:426} INFO - Running <TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [running]> on host ip-172-31-45-144.ec2.internal
[2024-06-20T21:25:52.054+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Airflow' AIRFLOW_CTX_DAG_ID='nba_data_pipeline_dag' AIRFLOW_CTX_TASK_ID='dbt_run' AIRFLOW_CTX_EXECUTION_DATE='2024-06-18T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-18T00:00:00+00:00'
[2024-06-20T21:25:52.058+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-06-20T21:25:52.071+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2024-06-20T21:25:52.072+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /home/ubuntu/nba_project && dbt run']
[2024-06-20T21:25:52.086+0000] {subprocess.py:86} INFO - Output:
[2024-06-20T21:25:54.204+0000] {subprocess.py:93} INFO - [0m21:25:54  Running with dbt=1.8.2
[2024-06-20T21:25:55.229+0000] {subprocess.py:93} INFO - [0m21:25:55  Registered adapter: snowflake=1.8.3
[2024-06-20T21:25:55.793+0000] {subprocess.py:93} INFO - [0m21:25:55  [[33mWARNING[0m]: Did not find matching node for patch with name 'top_100_all_time' in the 'models' section of file 'models/schema.yml'
[2024-06-20T21:25:56.006+0000] {subprocess.py:93} INFO - [0m21:25:56  Found 9 models, 4 sources, 444 macros
[2024-06-20T21:25:56.008+0000] {subprocess.py:93} INFO - [0m21:25:56
[2024-06-20T21:25:57.279+0000] {subprocess.py:93} INFO - [0m21:25:57  Concurrency: 1 threads (target='dev')
[2024-06-20T21:25:57.281+0000] {subprocess.py:93} INFO - [0m21:25:57
[2024-06-20T21:25:57.287+0000] {subprocess.py:93} INFO - [0m21:25:57  1 of 9 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ........... [RUN]
[2024-06-20T21:25:57.769+0000] {subprocess.py:93} INFO - [0m21:25:57  1 of 9 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ...... [[32mSUCCESS 1[0m in 0.48s]
[2024-06-20T21:25:57.772+0000] {subprocess.py:93} INFO - [0m21:25:57  2 of 9 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores ......... [RUN]
[2024-06-20T21:25:58.421+0000] {subprocess.py:93} INFO - [0m21:25:58  2 of 9 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores .... [[32mSUCCESS 1[0m in 0.65s]
[2024-06-20T21:25:58.424+0000] {subprocess.py:93} INFO - [0m21:25:58  3 of 9 START sql view model NBA_STATS_dbt_nba_stats.staging_player_stats ....... [RUN]
[2024-06-20T21:25:58.961+0000] {subprocess.py:93} INFO - [0m21:25:58  3 of 9 OK created sql view model NBA_STATS_dbt_nba_stats.staging_player_stats .. [[32mSUCCESS 1[0m in 0.54s]
[2024-06-20T21:25:58.964+0000] {subprocess.py:93} INFO - [0m21:25:58  4 of 9 START sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [RUN]
[2024-06-20T21:25:59.424+0000] {subprocess.py:93} INFO - [0m21:25:59  4 of 9 OK created sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [[32mSUCCESS 1[0m in 0.46s]
[2024-06-20T21:25:59.428+0000] {subprocess.py:93} INFO - [0m21:25:59  5 of 9 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news ...... [RUN]
[2024-06-20T21:26:00.550+0000] {subprocess.py:93} INFO - [0m21:26:00  5 of 9 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news . [[32mSUCCESS 1[0m in 1.12s]
[2024-06-20T21:26:00.554+0000] {subprocess.py:93} INFO - [0m21:26:00  6 of 9 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores .... [RUN]
[2024-06-20T21:26:01.479+0000] {subprocess.py:93} INFO - [0m21:26:01  6 of 9 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores  [[32mSUCCESS 1[0m in 0.92s]
[2024-06-20T21:26:01.482+0000] {subprocess.py:93} INFO - [0m21:26:01  7 of 9 START sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats .. [RUN]
[2024-06-20T21:26:02.434+0000] {subprocess.py:93} INFO - [0m21:26:02  7 of 9 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats  [[32mSUCCESS 1[0m in 0.95s]
[2024-06-20T21:26:02.437+0000] {subprocess.py:93} INFO - [0m21:26:02  8 of 9 START sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [RUN]
[2024-06-20T21:26:03.522+0000] {subprocess.py:93} INFO - [0m21:26:03  8 of 9 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [[32mSUCCESS 1[0m in 1.08s]
[2024-06-20T21:26:03.525+0000] {subprocess.py:93} INFO - [0m21:26:03  9 of 9 START sql table model NBA_STATS_dbt_nba_stats.top_100_2024_all_time ..... [RUN]
[2024-06-20T21:26:04.501+0000] {subprocess.py:93} INFO - [0m21:26:04  9 of 9 OK created sql table model NBA_STATS_dbt_nba_stats.top_100_2024_all_time  [[32mSUCCESS 1[0m in 0.97s]
[2024-06-20T21:26:04.505+0000] {subprocess.py:93} INFO - [0m21:26:04
[2024-06-20T21:26:04.506+0000] {subprocess.py:93} INFO - [0m21:26:04  Finished running 4 view models, 5 table models in 0 hours 0 minutes and 8.50 seconds (8.50s).
[2024-06-20T21:26:04.554+0000] {subprocess.py:93} INFO - [0m21:26:04
[2024-06-20T21:26:04.556+0000] {subprocess.py:93} INFO - [0m21:26:04  [32mCompleted successfully[0m
[2024-06-20T21:26:04.556+0000] {subprocess.py:93} INFO - [0m21:26:04
[2024-06-20T21:26:04.556+0000] {subprocess.py:93} INFO - [0m21:26:04  Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[2024-06-20T21:26:05.157+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2024-06-20T21:26:05.157+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-06-20T21:26:05.225+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=nba_data_pipeline_dag, task_id=dbt_run, run_id=scheduled__2024-06-18T00:00:00+00:00, execution_date=20240618T000000, start_date=20240620T212551, end_date=20240620T212605
[2024-06-20T21:26:05.260+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2024-06-20T21:26:05.291+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-06-20T21:26:05.292+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-06-20T22:08:02.583+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-06-20T22:08:02.630+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T22:08:02.639+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [queued]>
[2024-06-20T22:08:02.640+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2024-06-20T22:08:02.652+0000] {taskinstance.py:2330} INFO - Executing <Task(BashOperator): dbt_run> on 2024-06-18 00:00:00+00:00
[2024-06-20T22:08:02.662+0000] {logging_mixin.py:188} WARNING - /home/ubuntu/nba_ns_venv/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=9703) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2024-06-20T22:08:02.664+0000] {standard_task_runner.py:63} INFO - Started process 9780 to run task
[2024-06-20T22:08:02.663+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'nba_data_pipeline_dag', 'dbt_run', 'scheduled__2024-06-18T00:00:00+00:00', '--job-id', '1692', '--raw', '--subdir', 'DAGS_FOLDER/nba_data_pipeline_dag.py', '--cfg-path', '/tmp/tmp7mt8b3dc']
[2024-06-20T22:08:02.665+0000] {standard_task_runner.py:91} INFO - Job 1692: Subtask dbt_run
[2024-06-20T22:08:02.758+0000] {task_command.py:426} INFO - Running <TaskInstance: nba_data_pipeline_dag.dbt_run scheduled__2024-06-18T00:00:00+00:00 [running]> on host ip-172-31-45-144.ec2.internal
[2024-06-20T22:08:02.925+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Airflow' AIRFLOW_CTX_DAG_ID='nba_data_pipeline_dag' AIRFLOW_CTX_TASK_ID='dbt_run' AIRFLOW_CTX_EXECUTION_DATE='2024-06-18T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-18T00:00:00+00:00'
[2024-06-20T22:08:02.928+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-06-20T22:08:02.942+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2024-06-20T22:08:02.943+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /home/ubuntu/nba_project && dbt run']
[2024-06-20T22:08:02.956+0000] {subprocess.py:86} INFO - Output:
[2024-06-20T22:08:06.297+0000] {subprocess.py:93} INFO - [0m22:08:06  Running with dbt=1.8.2
[2024-06-20T22:08:07.380+0000] {subprocess.py:93} INFO - [0m22:08:07  Registered adapter: snowflake=1.8.3
[2024-06-20T22:08:07.890+0000] {subprocess.py:93} INFO - [0m22:08:07  Found 9 models, 4 sources, 444 macros
[2024-06-20T22:08:07.892+0000] {subprocess.py:93} INFO - [0m22:08:07
[2024-06-20T22:08:09.186+0000] {subprocess.py:93} INFO - [0m22:08:09  Concurrency: 1 threads (target='dev')
[2024-06-20T22:08:09.188+0000] {subprocess.py:93} INFO - [0m22:08:09
[2024-06-20T22:08:09.191+0000] {subprocess.py:93} INFO - [0m22:08:09  1 of 9 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ........... [RUN]
[2024-06-20T22:08:09.762+0000] {subprocess.py:93} INFO - [0m22:08:09  1 of 9 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_news ...... [[32mSUCCESS 1[0m in 0.57s]
[2024-06-20T22:08:09.765+0000] {subprocess.py:93} INFO - [0m22:08:09  2 of 9 START sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores ......... [RUN]
[2024-06-20T22:08:10.289+0000] {subprocess.py:93} INFO - [0m22:08:10  2 of 9 OK created sql view model NBA_STATS_dbt_nba_stats.staging_nba_scores .... [[32mSUCCESS 1[0m in 0.52s]
[2024-06-20T22:08:10.292+0000] {subprocess.py:93} INFO - [0m22:08:10  3 of 9 START sql view model NBA_STATS_dbt_nba_stats.staging_player_stats ....... [RUN]
[2024-06-20T22:08:10.816+0000] {subprocess.py:93} INFO - [0m22:08:10  3 of 9 OK created sql view model NBA_STATS_dbt_nba_stats.staging_player_stats .. [[32mSUCCESS 1[0m in 0.52s]
[2024-06-20T22:08:10.818+0000] {subprocess.py:93} INFO - [0m22:08:10  4 of 9 START sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [RUN]
[2024-06-20T22:08:11.280+0000] {subprocess.py:93} INFO - [0m22:08:11  4 of 9 OK created sql view model NBA_STATS_dbt_nba_stats.staging_top_100_players_stats  [[32mSUCCESS 1[0m in 0.46s]
[2024-06-20T22:08:11.283+0000] {subprocess.py:93} INFO - [0m22:08:11  5 of 9 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news ...... [RUN]
[2024-06-20T22:08:12.284+0000] {subprocess.py:93} INFO - [0m22:08:12  5 of 9 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_nba_news . [[32mSUCCESS 1[0m in 1.00s]
[2024-06-20T22:08:12.286+0000] {subprocess.py:93} INFO - [0m22:08:12  6 of 9 START sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores .... [RUN]
[2024-06-20T22:08:14.503+0000] {subprocess.py:93} INFO - [0m22:08:14  6 of 9 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_nba_scores  [[32mSUCCESS 1[0m in 2.22s]
[2024-06-20T22:08:14.506+0000] {subprocess.py:93} INFO - [0m22:08:14  7 of 9 START sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats .. [RUN]
[2024-06-20T22:08:15.671+0000] {subprocess.py:93} INFO - [0m22:08:15  7 of 9 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_player_stats  [[32mSUCCESS 1[0m in 1.16s]
[2024-06-20T22:08:15.673+0000] {subprocess.py:93} INFO - [0m22:08:15  8 of 9 START sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [RUN]
[2024-06-20T22:08:16.564+0000] {subprocess.py:93} INFO - [0m22:08:16  8 of 9 OK created sql table model NBA_STATS_dbt_nba_stats.transformed_top_100_players_stats  [[32mSUCCESS 1[0m in 0.89s]
[2024-06-20T22:08:16.567+0000] {subprocess.py:93} INFO - [0m22:08:16  9 of 9 START sql table model NBA_STATS_dbt_nba_stats.top_100_2024_all_time ..... [RUN]
[2024-06-20T22:08:17.748+0000] {subprocess.py:93} INFO - [0m22:08:17  9 of 9 OK created sql table model NBA_STATS_dbt_nba_stats.top_100_2024_all_time  [[32mSUCCESS 1[0m in 1.18s]
[2024-06-20T22:08:17.753+0000] {subprocess.py:93} INFO - [0m22:08:17
[2024-06-20T22:08:17.753+0000] {subprocess.py:93} INFO - [0m22:08:17  Finished running 4 view models, 5 table models in 0 hours 0 minutes and 9.86 seconds (9.86s).
[2024-06-20T22:08:17.886+0000] {subprocess.py:93} INFO - [0m22:08:17
[2024-06-20T22:08:17.887+0000] {subprocess.py:93} INFO - [0m22:08:17  [32mCompleted successfully[0m
[2024-06-20T22:08:17.888+0000] {subprocess.py:93} INFO - [0m22:08:17
[2024-06-20T22:08:17.889+0000] {subprocess.py:93} INFO - [0m22:08:17  Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[2024-06-20T22:08:18.325+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2024-06-20T22:08:18.326+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-06-20T22:08:18.380+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=nba_data_pipeline_dag, task_id=dbt_run, run_id=scheduled__2024-06-18T00:00:00+00:00, execution_date=20240618T000000, start_date=20240620T220802, end_date=20240620T220818
[2024-06-20T22:08:18.410+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2024-06-20T22:08:18.439+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-06-20T22:08:18.441+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
